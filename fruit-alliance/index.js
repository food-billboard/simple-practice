(function () {
	// constants
	const Container = document.querySelector("#app")
	const Canvas = document.querySelector("#canvas canvas")

	const ContainerWidth = Container.clientWidth
	const ContainerHeight = Container.clientHeight

	const BORDER_SIZE = 10

	// ------------images------------

	// 九宫格图片
	const GRID_IMAGES = [
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAgVBMVEUAAAC/v7+/v7+/v7+/v7+/v7/AwMC/v7+/v7+/v7/AwMC/v7+/v7/AwMC/v7+/v7+/v7+/v7/BwcG/v7+/v7+/v7+/v7+/v7/AwMDAwMC9vb2+vr6/v7+6urrAwMC/v7/AwMC/v7+/v7+/v7/Gxsa/v7+9vb2/v7/b29u/v7++vr6cwWT9AAAAKXRSTlMAIenXiX/3lk/s37+qMBm5kkI7I/zz3NDLjmhcNBHDnnJhRyoSrKIUB6X+iTQAAAFBSURBVEjH5dTXbsMwDAXQ6yGveMRx9mqapuP6/z+wsQsnKEQx8Wt7XgwZIikJlPAfTCcYK+AbxinIV4yzJV8wTkUGGMWbkzxjjJBXeR+ce3DaT8I9UKDjs1N2h02DMvZ3EMXkFH3umj1zLbKgSQJWkB1WpB8w9zYZf2SbDZmTTOCQkEzZafmLD5eGDu7m+cr6/O2TIWbfrSylyACxHXbm+wwxZVPUUQbLklFFlySQWi6kYiE29oyaVrw+ETUZBKlSglxBsKDGh4Cadg5bSV0pnZhuBsuOup30pui2sNTU1bB47A29b4082KiTX2FNAEEoLOv+J4TAEyfftyJZ062CKBlyt1aleQPZygoYxh9w+Iy0zpcVahfLGqlO1EBzWA97vn3XBzxwSvvJQ0B6wmOXcHmrsgwveE5h4qN/jE2BP+4b3JSRk0KKAk4AAAAASUVORK5CYII=",
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAh1BMVEUAAAC/v7+/v7+/v7+/v7+/v7+7u7u/v7/AwMC/v7++vr6+vr7AwMC/v7+/v7+/v7/AwMDAwMC/v7+/v7+/v7/AwMC/v7/AwMC/v7/AwMDAwMC/v7+/v7/BwcG/v7/BwcGzs7O/v7+9vb2+vr6/v7++vr7AwMC9vb2/v7+9vb3CwsK/v7/AwMBSaFvqAAAAK3RSTlMA+Pz08OEK58PKFuXY0LKgM+u0ihD23b3UrXx3YFc7KAVKHqebknFtaCMqIckIdQAAAcxJREFUSMftldl2qjAARZuEUUArVnHWDrfD3fn/7yshhOKqprD62v3gAyubk5wkcvfHVRb/xhrv8D7OOBdQnEcpbwjB2xgjWhMo1tEI5RUR1M7rcOMhx6SQPwxWdliF3eCQDE2wBLKhMVtqlFHYDjMmqlEEJmsySNlgEALD8w+vPx62s2ROXyFOZtvD8XtYdNi9VCEtq0aR1AS0hNXL7tDf2hSDpiVxSk5L41P0lOTijai0VnTP0FZJe8qpIEOCUjZplSPr33Z80AiC4tRfzEdKZvJdWBFLYoFGBSCskX5cFvCUuIktmz1JtMzk3C0CXT95+tZwgugWq9xYhySZXNmVCuk6a+azkj2jmlw9jSUtaV4vWUhRhc4ob5zPaNq0VQAxgZXXGKY37+d5g8IgjLS0254KNr4/jrk9AlLWCkG7mLVHMIph3qR0hD4jsnVRk0HXeuRR7unImjg7tXuPskeDalJCvk733qMs7LSc4qa28CglDmfGUkPpUUK0DnC4HBn6Clsq19Js1t3HkMhTmLDrZXOq74OVYp17Ktu3F2zaDjkZSamAvacwYYRjL3f2Q2Ulmunj5bPjM+jSk+KEPo9TPJ/a/zdqufvjN3wCZVNmcAJ+nYMAAAAASUVORK5CYII=",
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAilBMVEUAAAC/v7+/v7/AwMC/v7++vr6/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7/AwMDAwMC/v7/CwsLAwMC/v7+/v7+/v7++vr7BwcG/v7/AwMC/v7/AwMC/v7+/v7+5ubm/v7/AwMC/v7/AwMC/v7/AwMC+vr6/v7+4uLi/v7/BwcG+vr6/v7++vr6/v79dp86wAAAALXRSTlMAf+22qo369dvJ5uCuo4VhNCnUiXVtOhqzm5dQTEcRwbt4aFtWJx4Izj8vj2bZbpAxAAABWUlEQVRIx+3U2XKCMBhA4YRF9lVxQ9ytS3ve//Vaq1bTAoaZXvrdZs6EkB/Ei5bMzLomFrJjccLZd0z62B2LBH/UrVjBVnSws11wZkJPyYUDoWZSeT0wIACOQtM+fUswACKhb4DP2VA/MTE4m2gXbxgOZ26He19yMddNXEzodJgt7oGLRK+Ye0Rc2bqfiWdyZSorTWMag+TGEg8kQVFXrEEuqH2wKAdrV3PvyAk/CnUtBD9Rg2oBUnJXKssG5hK8OL1f+hTcrcUD9cAfEEwDIJfrsirsMHdwppVSeEKVA5NBZHCTx8O+wyOpFllqAHhxEU/GZmQXWdb3UaVKIfHDHt/8ryCeWgt+GwuFAfRoN1OTkKfGf4cPjU0UO5o0D/6RVlLUkLRYilobGr2LBkO37kX3CDai0SisCbBHok3aD1C3sobP/8HJ2OXmsEqFnvmpHKzWm1kmXv7FJ43Vakw//8qTAAAAAElFTkSuQmCC",
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAflBMVEUAAAC/v7/AwMC/v7+/v7+/v7+/v7++vr6+vr7AwMDAwMC/v7/AwMC/v7+/v7+/v7+/v7+/v7+/v7/AwMC+vr7AwMC+vr7AwMC/v7/AwMC/v7/Dw8O/v7+/v7/AwMC+vr7CwsK/v7/AwMC+vr6+vr7CwsK+vr65ubm/v7++vr7QbbWHAAAAKHRSTlMAf/ny2oXj0zS5tKb17eC/lW1jYD8iGOjMjUcHn5yKZyooenlORycLiACVewAAAQNJREFUSMft0cdyhDAQBNAhCAQsOcNGx/b//6CNS9LKBBUX33gnimHoLokOh8N/syZperYMzmlqTcRKgN0CsXLBjy8YqA8ushh2k8UKmGklCrEybLZaDAaxMuoT8/JIQoRf9laIGoUkFfKVmY2cpBon7HBCTUomYjbCHDHM6OnhiGHiYsH15eaDNExW63rM9LGsxUjXqL+3N+ZqCezVUc8N/fEGxef38hoFQXQt79x/HjenmZt2G05YVk1TFWGs3XFFCy8wymlFBSRY1QIlraoDxB4WvBgdpw0js+HNkhIPNvukbTyaftuqgOm8I05mQ+9D07F32uEjz0Lfcfwwy2s6HHTf6YRtmv+W23MAAAAASUVORK5CYII=",
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAh1BMVEUAAAC/v7+/v7+/v7/BwcHAwMC/v7+/v7+/v7+/v7+/v7++vr6+vr6+vr6/v7+/v7+/v7/AwMC/v7/AwMC/v7+/v7+/v7+/v7/AwMDBwcGzs7O/v7/AwMC/v7+/v7+/v7/BwcG/v7/AwMDAwMC/v7+/v7+/v7+/v7+/v7+/v7+9vb28vLy/v78vMbeGAAAALHRSTlMAQO/MELOvpI95b2c1Hvh/WxXY1dDHqkooCQXq38S/lmJWRLqZhWBMMJuLLnAVVIQAAAEwSURBVEjH7dPJVoNAEEDRAgzzPEMSM5hJff//fbrT09CNHLe5+3eqqabl6d9eVheJje1a64a4AO7KWUlmUyvNclTjrt6BzYrvKbpjkIUXmjzMgmO3fMDbBoWXG4PIAbYo6khfeODsmbHRFS0cKmY188Ur5BUa3lxxAHHRyqbFHfwMg/sk2VD1NgrjCs5wOmCQclZvBE9KjK5K4pMXmO0nG36xWKAkFXJamdhIuDJJGQLMUiUp+TxhVk5usosxe1OSK8cBM09JbgTiYOQrSUwjPkbR9LXEFibloCYh7+aTBaIqdpwj9HaFTIRsTGNCmRod2hwdZ5QZ8Zb2g3lpL7M6qH1m9aJhNdDumLBj0Rp82Dq2UriFmMQXgJQfniVL+mD/6++NEvmTMXlY3x7JKE+qL54am09L6hnyAAAAAElFTkSuQmCC",
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAeFBMVEUAAAC/v7+/v7+/v7/AwMC/v7/AwMDAwMC/v7++vr6/v7/AwMDAwMDAwMDAwMC+vr7AwMDAwMDAwMDAwMC/v7/CwsK+vr65ubnAwMC/v7+/v7+/v7++vr6+vr7AwMC+vr69vb25ubm/v7+/v7+9vb28vLy/v7/AwMD39g5GAAAAJnRSTlMApvv28OGQ5cyVdGZaTDgsz7qbgGAhFQvp1sO1ropsQz4OCN5GJugv4K8AAADtSURBVEjH7dXHFoIwEIXhEBKaghV7L5f3f0MXHuVoJhc4LuXbuPodM1JU7z8sh9PxZn9sH5wjPNlBy+IU422ybJUMUVuXTd+fjldhaOxrjJ4pLluhZowN5hce3Cw+BQvFHeC4FvxHQaCPdEmicOQtSg1Z4k0m8PFtuYCX9qxtB3QdE5JkLRZ3MOLSBmDmUhKB2UtJACbonmylJIWoIlP48SMpGYE5dP4rUYjJlhSxEuX0KLLEWRW9XviYqfKJnCHPz3ihut6XOXtyb1C5B+JP8csOqNzrnsu+RiSFalSmuq5s1v7lZQCTpLnq/e4Bg3FyNbkBh6UAAAAASUVORK5CYII=",
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAh1BMVEUAAAC/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7/AwMC/v7+/v7/AwMC/v7+/v7+/v7/CwsLAwMC/v7/AwMDAwMC/v7+/v7+/v7/BwcHBwcG/v7+9vb3BwcG+vr7Ly8u1tbXAwMDAwMC+vr7AwMC/v7++vr6+vr7AwMC/v7+/v7++vr4t8lTaAAAAK3RSTlMAcJvu25VhMvjp4NHNuIBpTUEp+tTJs6+MelJGNyMZFQ0I8b+kcV1aPKUsuNmmKAAAASpJREFUSMft1VtzgjAQhuEtlQKCiCIH5eCpWtuP///7StphhqZLNly3zwV680oyuIH+gu3L7GKHembiACuyVZQJkYdev7TKzTdyAiDf3FTiHh0AFskzepG6ZAt19eTkFYOvOCDZGj84ZCHCtw7MungHtaAU8FWxJyt1pjai9r60/wsc3Ch5wFmfyMZ5e38auVd1KwSFj1/C/Xm6aJZgLTzjk+cdiXfFpIIvTikGHfSvDzaJYVCyybv20934LhGbrGDgs4kLgx2bbKCThyAYbUR9jHmGgeS5NOECzXCvoJlKSjCESQvACg2DcwPLOJwLJhCO2jcwKjIK5aco3+byQYIMmlg+kPS512dYnoE1yRKMXclGjpHEKmm4ZcmvY2XWMd7GS/hpGLf0T/cJN1V3Stgf5LEAAAAASUVORK5CYII=",
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAhFBMVEUAAAC/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7/AwMC+vr6/v7+/v7/AwMDAwMDAwMC/v7/AwMDFxcW/v7+/v7+/v7/AwMDAwMDAwMDAwMC/v7+/v7+/v7+/v7/ExMTAwMC/v7/AwMDAwMC/v7+/v7/AwMDCwsLAwMC/v7++vr7tOBD/AAAAKnRSTlMAv/t/8t/T0OpLNOZxQu7Xw6yMWxH49cu4spNmOiYgGgjOpJ6bfWFVKn4imSQwAAABaklEQVRIx93V2XKCMBiG4T8hAWQRRNyXutd+uf/7K04zBUNCOG2fcfQ/eYXEMNIfNnkQHYIgoDHymmjOABQApmO+XQJSIF5yNFhGftcwYkwu0AgnNCTJJjW9KAZN3sjtVKUAFpu8mcVvEs3cxSegoF5vV6K4REO9kvVA0cpIlkrPDK61fMToyItSXwQoV45ki65oFbYzcvtWLdClIqn0yBmO1tvSt9HiPx/xWcJ+WgqYOASQCgVIawIbvhF6SvsFU7BoN6B/awFaqjPydjb3bAavu5Gk8DobyRReoZGE8DJP8wUKHnPzp+d4p2AoyHSHR0I9O+Mi+mVfiZbwtwKqOzuesX0IpwvZ1QKw78KSXFLXjglnsnElkTOpXEnmTI5LezOtyenhPCtuW4W+3VBximFSIqEhT8tahgs69AL+JI/QPI4R+ezNJzojr9M8iNFxpDF2ndVUZPD+aaxprC9d3Gi8Q7BesWpP/943X7mbHNdJk6wAAAAASUVORK5CYII=",
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAh1BMVEUAAAC/v7+/v7+/v7+/v7+/v7+/v7+/v7+8vLy4uLi/v7+/v7/AwMC/v7++vr6/v7/AwMC/v7/AwMC/v7+/v7++vr7AwMDAwMC/v7++vr6/v7++vr7AwMC/v7+/v7/AwMC/v7+/v7/AwMDAwMC/v7+/v7++vr68vLy/v7+/v7/IyMi/v7++vr5S6TtXAAAAK3RSTlMAsEnY9IqXkSYIt4VhVS0V+L+8s390aVpPPTQb7OHd2NDNyMOsp0Uen3wOLDK3mQAAAQ9JREFUSMft1VtTgzAQBeBTEu5guRS0tNXW3tTD//99OkynYkNIeHJ0+j3xskN2s2eCv2mOqRJYelpdPtwKtl797kAeH2DrkSIFZnyGvYhME/KAzsrwg6DrhpSCfMe89nahuZFdHECQXypvTQGzkMzcY1ciSBnYNU8KXtQYFyy86BifDrxa7/M8n43O2ilIZuzb1DBY8CfZAFY17bUkgQWfPcJqZ7Yt+1xzQiRvRKbrl1SUxoVUxaPp4qAAeoIK0wg4aCxrS2roUxZTYwmdGTWce8lvlrjTr/JEjfPktdxA74WDfOglLRUtx5+mrSlhqjCjosC4s+SN/QcMwkJp3Sz9npt8a2DJ8cvSq9IG/90nu615kcUOEMoAAAAASUVORK5CYII=",
	]
	// 火龙果 杨桃 香蕉 西瓜 苹果 橙子 草莓 葡萄 菠萝
	const GRID_IMAGES_ACTIVE = [
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAB71BMVEUAAACMxz+Mxj+8D1KMxj+Mxj+Nxz6Mxz66AEjJH12Nxz7OKWKMxj/IH12Mxj+Lxj66AE2Mxj2+AEq4cVnGGVmLxT+silLCFFbLJmDFGVnRHmmNxz7OKGG5AEuNxz69Bk+7AEy+BFHHHlvIIWCMyECLxj7LHlqLxD+MxkDLI1/KIGCpilDMJ2Ckj0yapEeMxj7NPGSRukGNxz/jNH+vdlLGP17PK2OMxj/IH12Mxj+ZpUXKIV+goEuMxz/GHVuljEzFGVqTs0KYsUSMxT+Mxz6/DVaNxz7NKGCOxkKPzD2Pv0CS20nVOmv///+Mxj//UKC/v7/mQoDIUmO9aVyAgIDfP3fMS2W2dljm5ub/e7j+T57vR4vDXWCxgFXf39+fn5/TNGhAQED//P3/6fP/3u3/yeL/s9b/p8/Ozs60tLT/b7H/ZKv/WaX/WKT/U6L6TZr2S5TsRojoRIPZPHDRQWnPR2fKT2RaWlqjmk3u7u7Z2dnJycnFxcXTPWnNSWa6b1quhVOVtET/0ubj4+P/zOP/w9//vtzV1dWxsbGqqqr6TZuZmZnzSpDtQ4njQnxwcHDVKWzRMGbQLmTBYl6+Zl2eokqgl0pISEibq0eSukPPRWfIRmFgYGDASly/UVuojlGnkU+TtkSQv0EjIyMGBgZFTZacAAAATHRSTlMAqpQg1r9/IRKMM/74699fMCsj/vbq6dzYy8OelZWKh39yZV1QR0RBPDsY/vf09PHu7Orn5eHd29HPzsq6urm4opCKbVJQTk0bGRAHX+DgqQAAAu5JREFUSMflk2dTGlEUhi9CsBtj19i7pvfee3LOvQhGFASx965g772X2NLbD81ZdmOc2d04fE0eZmCG3YfD+96z7H8g6ETAiomfCtAI4/xkgMqTA346QOUuxJoCM4JjAfbzAlIe9wHYDX7ZEPyXxCfSwxiTe0oAgL7vr6SyuZm9DIrX7oKu8iDGpd8uqARiwkxDLnBzronfY9q8vuWCBBM3GEOvgUSl7XroI9eOgXP+lOmQ2/eVX+b8DIC1jHhHeexQSUa8fk/7nO/ynYNRULCRBbuc6y/Pmyj+aXwAvGOg0A+E/bOOYg6jt+cXoXKC7jxU7LYysMIHs+aa5nFDIUsFGBune45gtXkBUllBRBRTcYNHPADCuz0KKl6YtFYunU9yF+hwTnOxC7nNNqDjDHCX5uMTQUdOadVsf5u0WSmKmkukHIn+Fn4zaX8P9ttayvkxOKTE6RAOZ4nyt8YBXFe1lIk/A7qE6KjoEKJLHmXthy9WpqYYvKN98giHaJypwZqZRuFQBpVZoVitFIHCmmibRRyqRsTZNrEGCkVqJQcUulrrkGhGoq61CxRy1Eo2yPSIBnR/REsVWkoRG0QPyGSrlXyQ6axAxCpssuCIBRErOkEmX60YlbZEvcWNzZJFWLBeKAdkZGo8cl2i1uJD3/BgNfqGqkqxVsileZgGSSDR3YZYjsQ0unGQPtu6QSJJSwkFiZUWOfnyIi5iORXQsgISoVqKcQsIZwuWr1PyhSZcH1mQFCcQW0amxR1/lnbKjPOIbjk+tvuz3GeaPPNIjVH8vcG94elq/Dm/TPH9jYXHMG1u0sVeUU/xh+n06UXUi1769iHTIeSsVBkdZVM1/ihFt/8opcIimS7R4TSms0GqeQjRR0pDJw0JNzJ9YuJoyWgt/YPKpbWkFYuTgugTkrwJzvY5uSyca3fCZnIIO4asSE+Jo3GKHrGpRkeJJzKLHU9IRuLG6hI9yEurG4kZqhF6NWSmpVxJScuMZv84vwBUeDNns/q6vQAAAABJRU5ErkJggg==",
		"data:image/png;base64,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",
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAB8lBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgGAMMCQECAQAAAAAAAAAAAAAAAAD/tgD/tgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAqHgAMCAD/tgAAAAACAQAEAwD/tgARDAAAAAAAAAAAAAAAAAD/tgAAAAD/twAAAAAAAAAAAAAAAAAAAAAAAAAAAAAuIQC9hgD/tQAmGwCbbwB4VQD/tgD0rwD/tgAAAABwTwDEjQDrqAD/tgBGMgAZEwb/tQA9LAAAAADhoQBfRAD/twBvUQA5JwBeRQAAAACYZwBgQwD/tgAAAAAAAAD/zUD/tgCAWwC0kS0WEQQIBgD/yTXNpTP/xSZnUhr/vxdNPRP/vBH/ugodFgTsqABzUgBmSQD/zDz/xy5SQhQmHwkwJAWSaQP/twJ2VQKidAH7swC1gQCfcQCOZQBDMAArHwD/yzvluDmOciOAZyD/wR5uWRs8Lwz/uQlkSwlcRAeEXgLxrADwqwC/iACcbwBcQgBWPQBMNgDxwjzSqTX/yDK+mTCvjSypiCqigimjgSP/wR3utB2/kx3gqBaUcRWIZxBAMxDRmw8zKQ2AYAqpfAm5hQLgoADRlQDFjQC5hACsewDnmFOoAAAAWXRSTlMAf4r37qqONCnf2si1hWxoYlBMRhv+/N3VzLSwq4t4Vjs4JxcQ/u7n5uLTwby5p6SbmZaGdnVgWi8fB/r39uzr4+DOx8G5t7a1r66ioqKbmX9+dW9dRT0qC8WkhowAAAKCSURBVEjH7ZTVVxtREId3iRsQElyLuxcodXfX350lISGEJLi7Q9G6u/+f3T0USraB7p7DI9/LPsz9dubcmTvcPoowlhnVKjrwKo0GaBpVKlGIUmnEojBHnZEBZKo5n603A9o4haft2EADpCpUHBYNoAWKsAYHp5BGg7MOxwABFZxyDuJED4QeHFCuWHG8FYsrqFRsHIL2yCe8C7oTVfS9dCkeL2kduUoVM86SC03UjiyFRibMp8iNx7SIWGVGjgVXaBndjIaVDmY5ks+LNc0w+glrWMS5g2EDbtJgPJoYDUG3PcLDFB3JiAH4EhrBLBungfDCypMAXXaEvoOvomBATNJMvQj7ay0uAoWyG3GcEY0bRAJaGHsifuxh4XycKwWSbYa/Ta8GzJlpktE9wZiPxuCUFb1+8roJQBIfY3dE61OLNdBU3xWNYeApYx19P2CRlV0Mga7dqtBikyTbvfSjREPAC8aYl0LypWQ05IsOna65batMsV7VRxvvpxcQUS/QKhrjbcGAbPh5FF1KgPCQiAouXE6vqUorIZHvC0AXE5mmEaSEJ9GOAQkujK3QNr71u4EpyWjuG8xDnHx7LrQA7gBGB8RMEksD8y6gtUkyOtpIkCfhci147xElwBXoCfV+np8FNgQJyRCTyMgG3jBPSze2+DDpYRv46RciDX4W8LqDsUee51NdXTOTzybYH5rnaBmRtz4PfOlk/+Dtk5pZxkXkDtD+ViZ1+ikoAHpuB7IS4Qp99LKtkrw+GhyJh6l+l0ebCmD165zfN/3K528TpyV0GNA7ud0wRJmAhLzR1f7+9rVRNwDd/3fkgzprIjZJzjBwyshtsNdmxNTHGbl99oTf07rjKDOfWesAAAAASUVORK5CYII=",
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAABfVBMVEUAAAAAAAAAAAAAAgADCQIBAwAAAADyWoYAAAAAAAADBwEAAADyWocAAAAAAAAAAAAAAAAAAAALBAYAAAAAAAAAAAAAAAAlUhQ1Ex4AAAAgSBIECQItZRkIEQQAAADzWobzWoYAAAAAAAAAAADxWobyWYYAAADzW4YnVhUPIAgNHgcCBAERBgkxbhobPA4ycBsOHggvaRkfQxAwahkeChAOIAchDBMAAAALDQYAAAAAAAAzExs7FiAAAAAAAADyWoYAAABczjK1Q2QDBwEJBQ9FmiU9iyFTuy1AkCMnWBXVUHa3RGipP2CKM1BZyDBNripDGio0cxzXUHivQWKiPVyaOlqMNFJ7Lkl3LUZIoicxcBstZRghShINHgfpV4HmVYDESW6+R2u7RWqUOFaRNlSDMU11K0FayzFLHTFClCQ6hCAdQhAaOw4KFgUIEwXMTHFuKT1tKTxVIDZWwS9RtSxPsStLqSk9FyI4fR42eh4qXxcRCBMNBhEcPw8QJQlGLlhlAAAAP3RSTlMAf4jx7NNG27+4s5WMbWMiGAj9PTUyJ/36+Pf34+Pauaejn5yDYV8q+vb29PLo6OTi4ODf39jXzMvLqnloZk6k+2dmAAACBklEQVRIx+3T1VcbQRQG8CHuQgR3q7vbfDfZJIQY1hKFUqBAkbrL3947S0K3OUkOL7zl97A7uzvf3Dtzzoqurq7z1qM4HJM9HUw6HPq9HnHizJz1yBQSicQB3sc6eIcDnoSpRmP4RlTBV9nBIipEZTQa8+EHURK9C7Kt5V4kifrgq0dsOCTaBVb5W5Zzr7Z4sKqetjalXN9elnIF2CU6hK0eCSJORH/wWsoNbVHKPS0jN379XJcxbU/Kba0oZRE1IoojKOoeYZ8ojX5e98VLrrTGg1yOL2tZ7qnIr/qRVr07RYMPF9QaXKaNnN5HH7yiwY+hAlEViEneiVr+eUZVXOGBOpO3QJWoMAS/OOXGoF6ml79/0Him2tImXzKaavKKXmQQbvFP1KzOcAm4Y5exnUaVnSxXWpD2e8C82ok5KgxMuJTSMw88sonHoic+XoRJGAVG8ZuI5gHLk2m7PGWffnwZWCJ1oKMB8Z9nQEVl4oA1MjfjGR8bG/fMzIWtOEm8AcKiyVNgX2VqAMyu2VAgEPK5LABqyZOErcVfA3wnVj6GwXGZWBrwihZCwK0UsVL1KA4WP0p/IZa6BsyKlvxOWIbz1CQ/bMH9sGgjaBrAyM3PZPDp9ggGTEHRXmQCwI2rpUIqn08VStfvApiIiM5sJisMHpps4gyiXrfLajZbXW6vX3R1Gf0FLdu8HfrWaXoAAAAASUVORK5CYII=",
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAABYlBMVEUAAAAJBQ8JAw4IBBAIBQ8JBQ8JBA4JBA4JBQ8KBQ8JBA4QABAIBQ8JBQ4IBA4IBA8JBA8IBA8JAA8MAAwAAAAJBQ/5Pkj5PkgJBA4JBQ8JBQ8JBQ8JBQ8IBRAIBg76PkgLBRAGBgwICBAAAABeGSMKBg8JBQ/5PkcKBg/5PkgJBQ76P0gIBRD3PEgvChQZCRT6PkijKjMJBQ81DxnVNT9FEx0VCRKBIiz5PkgtDhcKBQ4rDBaFIizRMz5NFB8JBA36PEb4O0gICA/yQED/M035PkgJBQ/3EShFEx3bN0H5Jzf5N0NTFiDqOkT5Okb4GC25DSH4NEHMMz2eKTNkGiRmCxpvChpDCRUYCRIfBxL5MD74IDKBISt7ICr3EyluHSfqECfWEiayDSCKDB2CCxs0DxkSBhDlOUP3Kzu9Lzr5KjqvLDfxIjSRJS+QJS+0HCt7GybgDyWmDR9SChcmDBZKCRaBI2QCAAAARXRSTlMAz0pA8Neyr6VnNhCZkH96c0IZEwX31szHxL+4qmJbWS8pIAn+6t+ShXttamBA+/ju7uzp3czKxa6qoJSQi1pOMyciFArqgBIxAAACAklEQVRIx+2UV1vUQBSGJ2Fbsr3h4hYWly7Ye2/zTQJZd9m+AlIU7F3/v4NE1Ewmax5uea9y8z7fKXNCTjg2Ud/GmQAC4TF/IWFwwlGfQYkAlKjf6hSEfc8gAB/9ZNVyMrEYQ6GymEiW1exIYakIB5GKp6ApAC5Pb25sTQ9gbG1+7v7YBxRNbkSAa9df0V9YaFHO2vuvfSAkM0rA7XFqU2/ZHyusCxTcjdPAPW5YH+hffLTqK6y5j4ibEQPIDUpNwDCpjWkBJs9hQyREQwXiC5TT+g502twy33WAwRtKnzbYDqAKSgjBhxcOu9gY4Ded+mE77KU4gjRwf+6o9bZlAIbVtitcfc62zwkxGm9wnMrgMS8w71DiqDymUt4ytosJYcLZZbnyjLFtwKEEQSblyhpjTFAugZyVK6tuSh61BSrnQMkLhVUnR6QEhU2qDzzb/4KiQ5lH+Qn12suu8DKXkCSnpMr6wSrjDkXnm5qTKg3G+tDEa9GXPbpvIlhzKinEpJW9ZqzLC3eSmUVaskx+L03MZohACiEeI5nXN6SISE5BSdimfS09KDnigj6D0l2Xstb5SeaniCsqoNwRMhrNPmAbIukCcPPKv89+pwcEdCKlFgdmrl78U9Sn3hAIe//K9Rg45/cMzt4QnFtpMoqp1ASOKGqPyH+Ry1THONVMjpzg5CeZ6/qQDnmKwwAAAABJRU5ErkJggg==",
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAABGlBMVEUAAADtYCFSvy7uYSLuYCDuYCHtYSHtXyLuYCDvXSBVuyrtYCH+fTztYCHtYCFRvy7tYCHtXyHsXyD4dDRRwC3uYCHsYCH4dDNRvy3uYCH/gT9SwC1TwC/tYCHtXiL/gD/lXhr+gED3cjP8eTv9fT79fDztYCH6dzdWvS9ssCx8qi3afjH+fj7tYCH9eztSvy5Svy7+fj3xaSf7ezv8fDvtYCFTwC3tYSLtYCD/f0HuYCL1bC/9eTb/gEDuXyL/gD5Uvi7sXyJRvi3/fT//gD3uXiFVwS7wZB9VuzPtWyT/gEDtYCFSvy7/fj7/czb/djj8eTnxZib5dDX4cjL9ezv/ejv0bC36dzbvYyT/fD3/dzjzaivhhDenky32e45HAAAASnRSTlMA/OPNppFiOSwVCu/q5uDRyr6wpqKblZOMdHBjWU1LJAn6+Pb09PTx8e/k4+HYz8O7uLaulIqBgX92amhnXFtGQ0M/PTYuISEPDlS1udwAAAFsSURBVEjH7dPnUsJAFIbhBVRUOgKCFLH33ntv+5FGSEDQ+78NWRzKhLOQGX/KM8PPd/acZcNG/ofpXCKyl753H7ynS7+8WZfFo7fUsT/tKsmVuiKvbLCn493gytLa1ma7OB0SzAV529f3xro3kR0y1d0271WujU0NO4I7VIywf2BxwXl/43lgcjecoGP1RVrML3CKiag0OeA0A2eS4plLlOGRXNsRlwHO6WRZmjSwQy/PpUxgkkqu5UkVmKCSWXmiAydUMsMpn5Z4AcCY+0RVldYpcfeDWZbYRXLK1cAbG6eSyQonaSpvAJeMssj7KM1fXVUA+MnksL9QNZGVgRAj5cv9Q9XFlRliFZpPcQwl1DUT4r3QCo3e/1C1RKdwHUCSyYzbPYlmtZap1IDQFJOK2c5ltGaBApP7iBm644NE9xXTinHYejcwHAUtAxi2WdWrpl0Tgc/PhnpLedARzjBXirdJXwAIRFN5NvJ3P1Xn4edEz6/PAAAAAElFTkSuQmCC",
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAABj1BMVEUAAADrAETRADxezj/iADzRADtczjxczzxczzzWAD1e0EHiAD9j1Ub7AEnRADz3AEhk1Un5AElczjtm1kxczzzvAEZczjzQADzSADzRADtn1k3/AEpczjxdzzzVADzRADtg1ETRAD1n20/5AEv/AEvTADn3AEjoAERh0kRczjxbzjzRADz1AEhczjz4AEn8AEr/AEv7AErYAD5j1Ehczjxl1kr7AErvAEXRADz+AEtn10zuAEXRADz/AEryAEfRAD1czjxm1U1m1kzRADzsAEbSAD1czT3yAEbrAET/AEpczT32AEhm1k3SADvQADvxAEf/AEv/AErRADtn1kzsAEjRADrPAD5Z0zdVzDPtAEn/AEvRADxczjxm1kz/l8HyAEfoAEP/Jmj/GV/4AEj2AEjrAETeAEDZAD7/fKz/X5b/S4b/D1bjAELhAEH/WZH7AEle0D//ear/caT/RYH/N3b/K239AEr0AEfxAEbtAEVg0kPXAD7/jLj/hLL/ZZr/Qn7/HmP/Bk/kAELaAD/TAD3nqvXiAAAAWnRSTlMAcNI/CNyylmVfMhn++fXv7d7e1sujnZuBeWNYUUlFOTcyKikiFPr59+/t6+rn5uHU0s/OzMjHv766uLi3srCsppmWlZKPi4qAf3pycWxoXlJPTkpDLCUXDw43dFUhAAAB+klEQVRIx+2UZ1cTQRSGrwlpRBEBEZQqYO+99957uXezAWMKCSIoRcGuP9z7ZgLHMrs7fNbnw3sm58xz3pm9c0L/Aps3rthozw2sUDmfy50gV5JXeomac4oerTeVjEcrnucl47egXHjaqT8clB2echDK4TYsm6OVc9i3GkorVrspmjQ2LkBZwCpFDhzSjVNQppzOBXq2m5Ntg3GDnBjo0JrWdhXa0uRKT6rjYdzrTD8jF5qG7q76hUxffzZCOLOGf+d1sRzrbgo2htfx37wsS2IwUFnLNvIiMkJ2jrLywsQyBeZRkbN24znu8baiUat81hwfx13KRS5oTb9VucaK748xV/03ZllvYC6JXLYq6xkt0/WWGc3JpRb+JhKzKic54C6oarEqlziIV0Etj9gw+wU5U0PmGSyKbCAru8zJPnzUHPMnMUZ53xjMIAXeH5t9Nh8NlyhpTohcDJ9+tYr8NKsxJ3lUyc4nQcpVtoCSbgpkj8XQkljIU77JoDHFwsRSSYZCMK/fvJWSjOpyXuQUhbHJKJXpr/hceTPGPgplv3FqOFhxDjPBFF1qDPWSlscUwRE2fMfcUdJFUdxjgLmbksQIRXKcwfyPoim5Q9Hc5zrvECU5Ri6cZsVoIg+clOFlZVFukxtD+xr/eYkMuZK9vpe3bD3QlaX//MlPkcgAfJeKs1oAAAAASUVORK5CYII=",
		"data:image/png;base64,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",
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAABZVBMVEUAAAD/0TH/twBgxkldwEX/zy3/tgBGpSxgxkpNsjZFoi1HpSz/1jtgx0r/tgBOsjb9zSpHpS3/twD/xx7/twBn1kxHpi1HpS3/tgBHpiz/yyZl1Uv/uwv/whNGpS3/tQD/twBhxEr/tABapTz/vwBgxkr/vhBOsjb/0jT/0zVgxUpgxUlm1kxm00pizUpKqzNgxkrOuxdgxktPszdHpS1PsjZHpi1gxkpOsjb/twBgx0v/yydn1kxgxUpOsTX/zShl1UtIpS7/tgBl1kz/vhFhx0pn1k1m10v/xx5IpixIpS5Qszb/whZNsjf/wRD/tQD/tABfyEtj1U7/tQD/tQBMszn/vAD/tgD/swD/20Vm1kz/tgBHpS1gxkr/yCJOsjb/0zT/yyf/2UH/2D7/1Tn/whZhy0pfy0X/uQVaxkG1zjacyTJ5xD5YwT5SuDmnzDOPxTL70DHexi2HsShnqCX0whf/vAtkGq37AAAAWXRSTlMAsUrAFdeLf2lWJ/j38N/Z0Mq/u7WvqpWRhoZzVkdGNSwpHQgI9vXz8/Hq4tzY2NjX183JvLm3r6afmpiXlZCOi4uFfHZkY19fXFhQUE8+Pj0zMSYfGxcOCvPHoxoAAAFsSURBVEjH7dRnT8JAGMDxBxXZIhtkKrj33nvvPXrXWqAgCO71+b2ACYGOO18Zjf/X/aU3nhz8zhq+LTaBsd1zKLcUBNZGF0oLmkMnzMQk2k0AHtQH7I2LomkDIQ/TGWybgbQvip39CK1Cg3FmJA60HI6AGeziPUIoON8jDAG9OM9blqfEHCEDgmBrBYZ2eJ4ffECkG0EwgnZmg2/CG4h4ibktE1s9aVLzT5Ex8rmlQki9RqBk4EvlEClHRPsxAJN5KxYKj8WnO0FYB4Z8ry/PEkdKJ1PvwzEW0pzmKqVwIxVcWLmqMtidoJBurqYkdmsLFycri1e0xJ4kJ1Ien2oQvQxQjyCpRJK4SV0ccIrlcZsqaVEmWXykSnTK5BrX/ZMfIPSrPFQlYeaBYR9L9uH3a5CttFykP3BM83lROC/KI5Ow1ooMdoJ2Z121e3deAqUrl1R1JX5gKKTPfK0p1TEdBcbCizrd7FooCn+9T5G5/5WpjkxNAAAAAElFTkSuQmCC",
	]
	// 抽奖图片
	const LUCKY_IMAGES = GRID_IMAGES_ACTIVE
	// 摆臂
	const Tree =
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAABHVBMVEUAAAA6NjU6NjU4NDQcjjccjjccjjccjjccjjccjjccjjccjjY6NjUcjjccjjccjjccjjccjjccjjccjjchgDYcjjc6NjUcjjccjjccjjccjjcbjjc5NjQcjjccjjccjjccjjccjjccjjccjjccjjccjjccjjccjjcbjjY5NTUcjjcbjjc5NjUcjjc6NjUcjjc6NjUcjjccjjc6NjUcjjccjjccjjcbjjcsXTY6NjU6NjUoajYcjjc6NjUrYzY6NjUehzc6NjUcjjc6NjUcjjc6NjUdiTc4OzUehjc5OTUxTzUfgzchgDcuVzYkdDYpaDYrYDY2QDUifjcjejcmbzYnbDYqZDYtXDYzSjU0RzU1RDUjdzc2QTU3PTUjejZd2wwyAAAARHRSTlMA9OYN+3dDPeGGMw369NG4mX4sGQX47aiNXDcwGwvx5szAvbGtok9LKCQVEQfc3NXJk5B5bGVTIfvh1crBwK6spIdrNo49DmIAAAJBSURBVEjHvZTXeuIwEEaHxNj0ThJgSe910zbb64yN6T2BJPv+j7EytlyAKPFecG74NaNjyXyS4SV+nefAJ+/pnX/lyK/y2b9y7n9jSwtRVmh5AUqATv0rsAgl5l8J/Ldytx9OBeUTmEs0mLxIbK8plrICjOwmTpBS0TlGeh1NErL5LtenUNpATigyY+ygwxrAciAQ+3QdQof4tLOGblJ/lih29I0eeoiPjZa1jndvisdQP8Z+rNApfNHovk00aprltEf5iib9jl5V29rzd1ii5ahUYcJTBS3Wyy6jiJx6lXS9pSYNJcLGA6JqjTeLLiXIi5V7jXT22G1DybBCk5rPWs/qFlzKpVmqNfTOcEAq4qqh5NbZqoRqS+ua/Q9zVqlU2KQxC0FDgV2WOsaj+ma75FJK6FBjW8/fTRSZDXtOZwPcbKGHIEwUSHiqBx6l6OmFwVIOz9DhCrwEvedFCQfo520WjreRk4Zpwrwl3R5fhdhrk4pSUgZ5L28UVzMwizw55/nLw3TcCE+kTqZGoXyoZE5gPpmDg0g5uosTxmT+nhXhFcqbaDIi/tceg5gkWjwQT1tio4C2otvxRqhcIKeq2TEhMiLIYSd61OWDrEBJ80kNIp00frkUgbKKJoNqt1Gtj4c4c+hf/MzUEYcNVB+t4b5A2UObftvJskC5QZu/LSdHBEpWQpumneI5geK+aqqddkGEIuEMUgaEpGaVAojJJaeNMLxGLuwR4vvwBpSELeRTWXgbpd87ISke2ivMvb//AJmz3x949HDeAAAAAElFTkSuQmCC"
	// 积分
	const ScoreImage =
		"data:image/png;base64,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"
	// 球
	const BallImage =
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAABpFBMVEUAAAAXMzIULy8SLy8wQS4wQS8UMTETMTEdNjAhOTAbNTBMTywfODAlOi8mOy8hOTAULS0AKiorPi8pPS8SMTESLy8QMTEUMjISMDA4RS5CSy0rPS9TUyteWSpFTC03RS43RC4uPy4XNDEoOy8eNzAjOy8SMTEnPC4UMTERMDAQMDAiOS88Ry5kXCp2ZikkOjBZVSwTMTETMTETMTEUMTEjOjATMDAUMTErPS4hOTATMTETMTEUMjIUMTHqpCD37L8TMTF+aiiifSWFjnh+aim0hySdooZMXlEmPje1t5ajfiaqgSXkoSDqqSrPlSLg2bH25bD15a/146n24afNyqXy0IHwyG1vfGqDglzvvlnvu1OkjEhhYTqKdTB/bjCmgCbGkSO6iiPyzXuCjHZqcFJJUjbsrTTrqSxOUCy+jCPSlyLNlCLYmiHGxKG+vZuvsZL01o+rrY/y1o6iporuuEwrQzwhPDdzYymFbSiLcCedeybrpSTqpiPIkiPamyHyzntqb1LuuU3tuE09SzXsrDRuYSpqYCqPdCl5aCmYeSexhSTioCEoVEnKAAAAPnRSTlMA/kAV9PCqZvr49PHu6eamDAby34k5LiEc+Pb18/Hw7+rZzZyZfXp1WEkQ8vLw7ezp49XFtq2enI+LbV1NNFF5h6YAAAKcSURBVEjH7dRVd+JAGMbxUGBbpFB393bd/ZmkkKLFtRSpu7uu+5femQnL2YO1d73p/4Kc5Lw/yBARbru5apobW64/rX7TZ1T1aNt1+t7+t+prgFGz2P7dBd76icY4fKVoEA0z+K/fnfUj5cVT1TGUPLIsg3WhvVNOiG3sJzJW+iHZbCp7kpnVtjLm2TIA54L4kRELIY7oNDOXyyVNg2aVCvucN5glZBY8t6GEqdTRsxo/DNHRJYUEzkCPpIFM1VBRUu9iA+IGJfsKmeIHDpx0zzhWRAx3AHxkk5AIJ2G+OxGyO/GndbAIMaWRNQ6yy4h/kgtC5haA0+raAvFOB2BaMVs+RuJZQbxiBuiqLCDmn0AyOnvOzc4ipJgiaMF5K3BkLiD6GcDuIAFlyQlIKbrZ829HPi2B9as3X1SIHsgqQgvzJYAmJhaRa+VuIXFDthGWP44iucWafFIFSixKsRR4Ui4PUNeUTzSAx5pLIamYRckmA9r3+USLYsV9hMVIVUseGRPXketrQln+ODAZZkQlY10suJbV42BN7kd2/Tt0OCUhwQymAsRhB1bqhfyefwOs80FC22KjMQmLe9yczUaTgPSqgFRq6DeJXiocbDBukQDfBDf8PtI0FpBadmZfLIRs8iX4GNkmzPDkaqGwwVY3JHtogw+FCSMRkjOdA0WI2ngM/DhUlkw4+Uz+mbRJXfRBrroATtnAeUAhS5SEDtKAu7uixOuiww3eB6IQBL1zdifdPhgSSnRn+ZL/QVFHlsyLC0wcPS79uu+7t8ZM0q6y2RixZkB79EQoXfNLrQssWZY9UHL1vBDKNmIyMJRr9b6+Urgi9YDe4FoDb+2k6+HrJuHqakf7Taq67jqdSjRXCNeupbGpWV0j3HZT/QWFSPNiqsjdeQAAAABJRU5ErkJggg=="
	// 障碍点
	const HinderImage =
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABrVBMVEUAAABFTU9DS09GTU5HTk9FTk9CTU9ETk5bUEJKTktdXFNJT01MUlBJT05FTU9ETU9ETU9CTVBQT0l2alZXUEVGTk9gX1NKUVBHTU1XWFFHTk5OT0lMT0tETU9ITUxDTU9FTk5ES1FsWUVwaFZOUEtXWlJVVE5jX1ReXVNNVFBITUxITkxKUlFMUlFDTU9GT1BDTlBJTExCTVCjyjmIdllDTU+FdFhsZVR+cFh3bFeawDqBclh5blY/o1BQqUxUYkxtZlVlYVRRWU9hr0lofEeLwT6PtTxtVTxpYlQxnFNUWlCu0E9LU09OWU6AaU1WY0xUq0tfdEhxiUSFo0CXxjx3WjyVvTudxDqgxjna6q/H34Z8b1eFcVVpZVRhYFJbYk9FUE9JU05LV01yYUxSX0xqXkxbakphd0h+ZUhleUdvtkVstEV3uUN6u0J3XUKGpkCNrT6RuDuiyTn4++/z+OXo8s7k8Mbg7b3W56bD3H651mi01F6y01oelVhjYlJZX1BbYE9IpU5jc0pkV0dqg0WjyEJ7m0J6mEJ3lkKCn0CNrj6TxD2Rwj2IrT1kUD3oW1n0AAAAM3RSTlMA+D38zrh9M/789/fu4uHHi0b+/f319PLx5+XOpaGVkYUp/vb18u/r5uHe1NHKv69zV0mAfd5mAAAB3ElEQVQ4y72SVXfjMBBG7VBDTZNyu8VlphkZYscOMzTJpsyM23aZmek3r5LabpL2ufccSQ/fPUcazTBnS8vdNg/L9ltsLafGppusUxQ4ThCdrlumk/mwew6RE3le5BB593Bz7ulGTIaJGo2qJMwjOi2NeVsIpffrB5NAmTxY/yBhqLU+H+nDECm9Bp0SCeHlc8f5/VYUCWSeZsCAiOi4ZwgWHrPl6edACQSgxs8crhmX+Hpw/lPm8avIHsDeGMAuXVCcR4dPE7xXMfdr6gUoKaiRUui2n8POAb2EDmnx6xMAeECXfowvSueva0K/IKvTU9CIX5VXXJrAcnz02cvfkZgexnaosME/NBtCcOsNbL/d0YXt1C6MbwQNwSPIq9BMfFVO9GrC7Qsc8Tc/4S/J/7uhCbY+DJerV2ufFIjRIn6ENztH9EHpkpIFGowptMQ/AEoAJuJqMmE2BsfajekS1FA+0o3mX9Kb9uNumcwCR/ZrQiRSbfjhNzKbIHVjZevBmewWHPHIfxjNzlQcQ0wdg2nEuUJ5ohrHvxfezVbaB5kGrNdkFBeWlovF5aWFjnziopVpwksuIaIQDApcvmJnvcwJRu8Q9xV+Ze2zvd01MMqcis9m7e2yDJmYs+U/FGh80IYYqJ4AAAAASUVORK5CYII="
	// 障碍点-抽奖
	const HinderLuckyImage =
		"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABqlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAFBAAAAAAAAAAHAwAAAAAFBAAIBQAAAAAAAAAAAAAJBQAcFAAOCQAAAAAAAAAMCgAAAAAGBAAAAAAOCwAAAABtWwAAAAAAAAAAAAAAAAAAAAAAAAAQDQAXEACniwAdFwAqHQD/zwD/2ABZSgD/2ABcPQD/1gAAAAD/yAAAAAD/1gD/ywD/2gD/1AArJAD/2wAqGwAAAAAgFQAAAAD/2gA2LQATEAD/2QD/2QCZgwBGPQAKCgD/1wAAAACtkgA6MQD/2gAAAAAAAAAAAAD/2gAAAAD/2wb/zwDfvwD/4Ej/3BTVtgC4nQD/3STpxwD/wwDjwgCqkQBVSAAXEwD/4lz/3R//1gDvzAD/yQD/vgD/ugDZugDIqwDYnQCulQCchQCJdQCAbQBnWABrRwBANwA0LABAKwArJQD/42z/4U7/30H/3jb/2w//1AD00QDtvgD2twDusQDKrQDEqAC/owC8oQCehwDChgCWgACQewCqegCqcgCRbwB5ZwCZZgByYQCIXgBgUgBNQgBIPgBJMQA8KAAzIgAgGwCITxOLAAAASnRSTlMAf1OzmY+GZ0s1D/z5+PLv7Orp5ePX1sGnoXVwcEM6OSAY/fr19fHv6+jn5+Hfzc3Jv7m3s7Kxr6eel5KSjYZxaWllXVRTTC4kCu4GRHIAAAGNSURBVDjLvZPVUgNBEEV3YxDc3d3d3eV2iCckuLu7u8s/s1lCMrsJ8EJxqubpnpquuVPN/T+Byl8EPuynNFPB8THcwPfXE1FceBip/YVBWkUS1VgXnFm3OZTQ3e8jaEJjyjVFELnKi6AUudBY31WWDwEdMDQ5VRwhF5QqYH4Pxo1NHUymmVlKSs1kczXxGCfnEYxGYI5W9l+jQnkmT6DOasA8jU/GgQnbGiuoSqtgXjQDGIabIYkQQG2wr9qFnBx6nF4uCcJyPCMoqN0CHQT0M8J5XLACByHep6ZH802GkW1ImHyJ9Aja8OYCWOxgEEZQEDuiB1h9OoZpcd4tTL0lcl5SqQ/QzwHWdecJ4Fg5w+5dCCPEq2rFlkWMwAUwZqM0pgdqqYDBYIFLGzEAsF1nRwVKikjG6BZEdkYBHFIDJ0EQXAx/tT1LWpnQWzkG6NffzWI+cU4Zsu8mZUeJp4OHSKJBTkoGH90KE0RuSJ3G+UJ8LhUCS4774Dr/KxGnUdBzcGxiLFOynHQK4P6aD3AOeEIE4OPnAAAAAElFTkSuQmCC"
  const BottomHinderImage = 'data:image/png;base64,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'
	const ServeBallImage = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABblBMVEUAAAAxOTQsQjYtQDYpSzgrRjhzi1omUToxOzROdE09QDlOWkM+QzouPzZOW0RMVkJESj1RXUYzMzMzMzNYZUkrRjdfcU5ZaEoqSThvhVhUYEczMzMtQzd5kl0tQjhbaUt8mV8zMzNme1InUDkzMzN6lF4pTjePsmxkdFAmUjqYumx6kF40NDS//3+t231/UCEzMzMXeUOUuG48QDmDomRVYUdQXUZCSDwoTTk5OTScxHOPsmuNr2mAnWJ2kFxzjFpQW0RIUj8xNjRIQTNXQixQPSrn9Nmwz5CIqWZ9mmBwh1hziFZrgFVofFNea0pDZkUYdkIyZUJKV0IdbUAeaD9HTj8hXz0mVDotQDYuPzY2NzVCPjNqRyVySyTg8c3J6Km+4pe34I2m0nmlz3ihy3Zhck9pdk5ZZ0oxd0g+ckhMaEgsd0ZKW0RCXUMac0IlbUI+WUA/RzssRTcwOjVTSTRNRDNPRDFKPC5mRidROSTTlefwAAAALnRSTlMA8ulLv7CAVzYQ+/b29e/r5uPe2dHQy8nIw7+/tpSTfnt3cHBkYkVCQDU0LiIENS1mrgAAAVVJREFUOMutksV6wmAUROvu7u4yuSE4FKe4O4W6u8vbN6R0QfiBDbM9J5PcL9NQ/zRP1xCGO6rzlcUaBUM7VXHnUuNyZxU+IqhJbWupyAeDOHFZrK9NFXgbnQNHx5obbStbGAtAzL75Nt7LFvqNkuC+D9vYQpe+IBy6BD7TzBQIfyFeO8fiU6qioA4lGxl8g/RFQUF8mnHHgB//uXqI0Zqcz2elh70KAKd0lyp7SY9HJMF3h84KwPvCZ2YYJ6icHMd9XUqHxGUVW6Jg1Dl/8lyezgBNLEylwoLY7PnMFSrsSuAiwr9tlgizFsDs4ApxmAF/hE+3lwjrOkD5IQkHRsDy9Cj7H7uCHgrKifxbJ31kUj6KPhPgsxcKfIA7ymvlu1olA7CXtVMAUAjXqfJVTSb2ABggaomQljoYixNUJqVBaVLRM40yB7E93q0hTVTdNNHeUM/8An3qSs1TL+IqAAAAAElFTkSuQmCC'
  const StopImage = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABoVBMVEUAAAA0NDQ1MzQzMzM1MzQzMzMzMzMzMzMzMzMzMzMwMDB2QHFgO15WOVQyMjIzMzM+NTo5MjkxMTE2NjZEREM+QTU+Pj47OzthczdFRURXPlBmeThrPldVNE5POEZUNkp6lThzPm9MOEozMzNGTjVYOktmPGJJUzU1NDVHQT09NTxQOU5OOExENj4zMzNCNT0yMjI0NDQ9MT0zMzMxMTFAQECEQmiEQn4zMzP///S+4k+k0Tw0NDRlLGG7u7R1P143NTU6NjeCgn1/QXlra2dvQ2ZyNWTWwM3AnrG3tq+YmJPmq4t3d3OBQWaVdGRtMmN8QGJnR1l6Y1ZVM1JcOlFmVk1WQE1tYklPO0ZHMEZ3gkP////w8Obdy9bKrr7ExLzHqbrAwLm3t7CwsKmoqKGmpp+meJKSkY2XkorZooV8fHiQVHaOUnWqgm9yP21wbWyHR2ybeWZ4OWWPcGFiOV9wYVhsXFRfRFReRFO2zFJrW1FiPFFnTVB0bUtONktXOkpKSklMQkdEOENpcUF4h0CUtj2GpzprgDhhdDdMVjU6PTRgAj6dAAAANnRSTlMASv1V+fr1qnU2E/3Oy5pmVj8iHP78+vn59/X19PLx7uvp5OPf2dXVxsW/uLOhkIthREM8KgR8wKg+AAABZklEQVQ4y+WRVXPCQBSFQwKF0kJpqbu7y+aGBHd3rbu7u+uvbiCh0Cn0uTP9XvbhfLP37lnsb6EkBL8L0AUj+dNhsRjodkIgzZMXQN0rfDDvFdA2nisXN9M0PKkSbzRdDTnHP9O0TqVSMS+sWPozH4gBwCMrJNgzDhhR9j0vbLRtIXfyhqgP3egfwFUFxFiWIFyZ3EToNnp+rUOwC0sURS1W1mR2mcBnphGLNqRF96suB5Vk3qGBrwn11jnEoYUpoDgMs+UlvDDkRjxXDNjveGHZYGJ6OEGhte6lcp/eCRsmXlgwwTrDvVjaYUMpLpltJ8CaXcNiAPB4aiV8z+kNQmY9sx8IXxyfhAOHep1Zxn/vKH7AGTqSNJr9Z5FY5NS/Q5Jkb7owRZPaa7FYvMEgmU3xYKZLYYM6SfwoK2/BsSwEIiEOuBBajXxslImUWA4EBf3FRWRRZ5+IqymXIpF3yyWEFPtXfALAN1jyg9S8JAAAAABJRU5ErkJggg=='

  // ------------images------------

	// eventemitter
	const EVENT_EMITTER = new EventEmitter()
	const EVENT_EMITTER_NAME = {
		// 碰撞
		ON_COLLISION: "ON_COLLISION",
		// 球体静止
		ON_SLEEP: "ON_SLEEP",
		// 下一球
		ON_NEXT_BALL: "ON_NEXT_BALL",
		// 下一步
		// ? 用于在释放下一球之前做一些判断
		ON_NEXT: "ON_NEXT",
		// 下一关
		ON_RESET: "ON_RESET",
		// 游戏结束
		ON_GAME_OVER: "ON_GAME_OVER",
		// 本关通关
		ON_GAME_WIN: "ON_GAME_WIN",
		// 游戏开始 游戏暂停后开始
		ON_GAME_START: "ON_GAME_START",
		// 游戏暂停
		ON_GAME_STOP: "ON_GAME_STOP",
		// 游戏启动 游戏一开始启动的时候
		ON_GAME_PLAY: "ON_GAME_PLAY",
		// 游戏静止 游戏通过一关后的暂时静止
		ON_GAME_STATIC: "ON_GAME_STATIC",
		// 游戏动画定时器
		ON_ANIMATION_REQUEST: "ON_ANIMATION_REQUEST",
		// 转盘抽奖 触发抽奖
		ON_LUCKY: "ON_LUCKY",
		// 转盘抽奖完成
		ON_LUCKY_DONE: "ON_LUCKY_DONE",
		// 点亮宫格
		ON_GRID_LIGHTING: "ON_GRID_LIGHTING",
		// 更新连线奖励
		ON_LINE_CONNECT: "ON_LINE_CONNECT",
		// 积分
		ON_SCORE: "ON_SCORE",
		// 信息获取
		ON_DATA_GET: "ON_DATA_GET",
	}

	const LUCKY_TYPE_MAP = {
		// 分数增加
		SCORE: "SCORE",
		// 连线点亮
		GRID_LIGHT: "GRID_LIGHT",
	}

	const COMMON_HINDER = [
		...new Array(6).fill(0).map((_, index) => {
			return {
				position: {
					x: (ContainerWidth / 7) * (index + 1),
					y: (ContainerHeight / 5) * 1.2,
				},
				lucky: false,
			}
		}),
		...new Array(4).fill(0).map((_, index) => {
			return {
				position: {
					x: (ContainerWidth / 5) * (index + 1),
					y: (ContainerHeight / 5) * 1.7,
				},
				lucky: false,
			}
		}),
		...new Array(3).fill(0).map((_, index) => {
			return {
				position: {
					x: (ContainerWidth / 4) * (index + 1),
					y: (ContainerHeight / 5) * 2.2,
				},
				lucky: false,
			}
		}),
		...new Array(6).fill(0).map((_, index) => {
			return {
				position: {
					x: (ContainerWidth / 7) * (index + 1),
					y: (ContainerHeight / 5) * 2.7,
				},
				lucky: false,
			}
		}),
		...new Array(2).fill(0).map((_, index) => {
			return {
				position: {
					x: (ContainerWidth / 3) * (index + 1),
					y: (ContainerHeight / 5) * 3.2,
				},
				lucky: true,
			}
		}),
	]
	const COMMON_LUCKY = [
		{
			type: LUCKY_TYPE_MAP.SCORE,
			value: 100,
			label: "100积分",
			image: ScoreImage,
		},
	]

	async function requestData() {
		let done = false
		return new Promise((resolve) => {
			let result = {
				lineConnectCount: 0,
			}
			const needKeys = Object.keys(result)
			function request(data) {
				Object.entries(data).forEach((item) => {
					const [key, value] = item
					const index = needKeys.indexOf(key)
					if (!!~index) needKeys.splice(index, 1)
					result[key] = value
				})
				if (!done && !needKeys.length) {
					done = true
					resolve(result)
				}
			}
			EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_DATA_GET, request)
		})
	}

	// game info
	const GAME_DATA = {
		score: 0,
		currentStep: 0,
		lineConnectScore: [10, 30, 60, 100, 150, 240, 300, 400],
		gridLightScore: 10,
		step: new Array(8).fill(0).map((_, index) => {
			return {
				hinder: COMMON_HINDER,
				// 抽奖除亮灯外的其他奖励
				// score 积分
				lucky: COMMON_LUCKY,
				// 判断是否赢了
				async isWin() {
					const data = await requestData()
					return data.lineConnectCount >= index + 1
				},
			}
		}),
	}

	// 缓存加载的图片
	const IMAGE_MAP = {}

	// utils

  function debounce(func, wait, immediate){
    var timeout, args, context, timestamp, result;
    if (null == wait) wait = 100;
  
    function later() {
      var last = Date.now() - timestamp;
  
      if (last < wait && last >= 0) {
        timeout = setTimeout(later, wait - last);
      } else {
        timeout = null;
        if (!immediate) {
          result = func.apply(context, args);
          context = args = null;
        }
      }
    };
  
    var debounced = function(){
      context = this;
      args = arguments;
      timestamp = Date.now();
      var callNow = immediate && !timeout;
      if (!timeout) timeout = setTimeout(later, wait);
      if (callNow) {
        result = func.apply(context, args);
        context = args = null;
      }
  
      return result;
    };
  
    debounced.clear = function() {
      if (timeout) {
        clearTimeout(timeout);
        timeout = null;
      }
    };
    
    debounced.flush = function() {
      if (timeout) {
        result = func.apply(context, args);
        context = args = null;
        
        clearTimeout(timeout);
        timeout = null;
      }
    };
  
    return debounced;
  }

	// 图片加载
	function loader(image, callback) {
		if (IMAGE_MAP[image]) {
			return (
				callback &&
				callback(IMAGE_MAP[image].dom, {
					width: IMAGE_MAP[image].width,
					height: IMAGE_MAP[image].height,
				})
			)
		}
		const dom = new Image()
		dom.style.objectFit = "contain"
		dom.src = image
		dom.onload = () => {
			const width = dom.width
			const height = dom.height
			callback &&
				callback(dom, {
					width,
					height,
				})
			IMAGE_MAP[image] = {
				dom,
				width,
				height,
			}
		}
	}
	function getCurrentStep() {
		return GAME_DATA.step[GAME_DATA.currentStep]
	}
	// 获取当前关卡的转盘图片数据
	function getCurrentStepLucky() {
		return getCurrentStep().lucky
	}
	// 获取当前关卡的障碍数据
	function getCurrentStepHinder() {
		return getCurrentStep().hinder
	}
	// 是否为球
	function isBall(object) {
		return object.__internal_type__ === "BALL"
	}
	// 是否为底
	function isBottomBorder(object) {
		return object.__internal_type__ === "BOTTOM_BORDER"
	}
	// 获取球的尺寸
	function getBallSize() {
		return (
			(ContainerWidth - BORDER_SIZE * 2) / 9
		)
	}
	// 唯一id
	function uuid(prefix) {
		return (prefix || "PREFIX") + Date.now() + Math.random() + Math.random()
	}
	// 是否为碰撞阻碍
	function isHinder(object) {
		return object.__internal_type__ === "HINDER"
	}
	//  是否为抽奖阻碍
	function isLuckyHinder(object) {
		return isHinder(object) && !!object.__internal_lucky__
	}

	// ------------matter-js------------

	const {
		Engine,
		Render,
		Runner,
		Body,
		Events: MatterEvents,
		Composite,
		Bodies,
	} = Matter

	// create engine
	const EngineInstance = Engine.create()
	const WorldInstance = EngineInstance.world
	// create renderer
	const renderInstance = Render.create({
		canvas: Canvas,
		engine: EngineInstance,
		options: {
			width: ContainerWidth,
			height: ContainerHeight,
			wireframes: false,
			background: "transparent",

			// showDebug: true,
			// showStats: true,
			// showPerformance: true,
			// showBounds: true,
			// showVelocity: true,
			// showCollisions: true,
			// showSeparations: true,
			// showAxes: true,
			// showPositions: true,
			// showAngleIndicator: true,
			// showIds: true,
			// showVertexNumbers: true,
			// showConvexHulls: true,
			// showInternalEdges: true,
			// showMousePosition: true
		},
	})

	Render.run(renderInstance)

	// create runner
	const RunnerInstance = Runner.create()
	Runner.run(RunnerInstance, EngineInstance)

	// ------------matter-js------------

	// ------------konva------------

	// 动画
	const Stage = new Konva.Stage({
		container: "#animation-canvas",
		width: ContainerWidth,
		height: ContainerHeight,
	})

	const Layer = new Konva.Layer()

	Stage.add(Layer)

	// 弹框提示
	const ModalStage = new Konva.Stage({
		container: "#modal-canvas",
		width: ContainerWidth,
		height: ContainerHeight,
	})

	const ModalLayer = new Konva.Layer()

	ModalStage.add(ModalLayer)

	// ------------konva------------

	// ------------event------------

	// ------------event------------

	// 球体
	class Ball {
		constructor() {
			this.create()
			this.append()
			this.eventBind()
		}

		instance

		disabled = false
		died = false

		create() {
			const size = getBallSize()
			this.instance = Bodies.circle(
				ContainerWidth / 2,
				size / 2,
				size / 2 - BottomHinder.WIDTH / 1.8,
				{
					render: {
						sprite: {
							texture: BallImage,
							xScale: size / 50,
							yScale: size / 50
						},
					},
					__internal_type__: "BALL",
					friction: 0.00001,
					restitution: 0.5,
					density: 0.001,
					__internal_type__: "BALL",
				}
			)
		}

		append() {
			Composite.add(WorldInstance, [this.instance])
		}

		onSleep(target) {
			if (this.died || this.disabled) return
			const { bodyA, bodyB } = target
			if (bodyA.id === this.instance.id || bodyB.id === this.instance.id) {
				// 两球碰撞游戏结束
				if (isBall(bodyA) && isBall(bodyB)) {
					EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_GAME_OVER)
				}
				// 球与底板碰撞则下一球
				else if (
					(isBall(bodyA) || isBall(bodyB)) &&
					(isBottomBorder(bodyA) || isBottomBorder(bodyB))
				) {
					const ball = isBall(bodyA) ? bodyA : bodyB
					const {
						position: { x },
					} = ball
					const index = Math.floor(
						(x - BORDER_SIZE) /
							((ContainerWidth - BORDER_SIZE * 2) / 9)
					)
					EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_GRID_LIGHTING, index, true)
				}
			}
		}

		onGameOver() {
			this.died = true
			// 清除球体
			Composite.remove(WorldInstance, this.instance)
		}

		onCollision() {
			if (this.died || this.disabled) return
		}

		eventBind() {
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_RESET,
				this.onGameOver,
				this
			)
			EVENT_EMITTER.addListener(EVENT_EMITTER_NAME.ON_SLEEP, this.onSleep, this)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_COLLISION,
				this.onCollision,
				this
			)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_GAME_OVER,
				this.onGameOver,
				this
			)
		}

		eventUnBind() {
			EVENT_EMITTER.removeListener(EVENT_EMITTER_NAME.ON_RESET, this.onGameOver)
			EVENT_EMITTER.removeListener(EVENT_EMITTER_NAME.ON_SLEEP, this.onSleep)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_COLLISION,
				this.onCollision
			)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_GAME_OVER,
				this.onGameOver
			)
		}
	}

	// 阻碍点
	class Hinder {
		constructor() {
			this.eventBind()
		}

		instances = {}
		static UNIT = 0.1
		static SIZE = Math.max(0.1 * getBallSize(), 5)

		disabled = false

		init() {
			this.instances = {}
			this.create()
			this.append()
		}

		create() {
			getCurrentStepHinder().forEach((hinder) => {
				const { position, lucky } = hinder

				const __internal_type__ = "HINDER"
				const __internal_id__ = uuid("HINDER")
				const size = Hinder.SIZE
				// ? 32是图片的尺寸
				const scale = (size * 2) / 32
				this.instances[__internal_id__] = Bodies.circle(
					position.x,
					position.y,
					size,
					{
						__internal_type__,
						__internal_id__,
						__internal_lucky__: lucky,
						isStatic: true,
						render: {
							sprite: {
								texture: lucky ? HinderLuckyImage : HinderImage,
								xScale: scale,
								yScale: scale,
							},
						},
					}
				)
			})
		}

		append() {
			Composite.add(WorldInstance, Object.values(this.instances))
		}

		onCollision(bodyA, bodyB) {
			if (this.disabled) return
			// 触发幸运抽奖
			if (
				(isBall(bodyA) || isBall(bodyB)) &&
				(isLuckyHinder(bodyA) || isLuckyHinder(bodyB))
			) {
				EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_LUCKY)
			}
		}

		onReset() {
			Object.values(this.instances).forEach((body) => {
				Composite.remove(WorldInstance, body)
			})
			this.init()
		}

		eventBind() {
			EVENT_EMITTER.addListener(EVENT_EMITTER_NAME.ON_RESET, this.onReset, this)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_COLLISION,
				this.onCollision,
				this
			)
		}

		eventUnBind() {
			EVENT_EMITTER.removeListener(EVENT_EMITTER_NAME.ON_RESET, this.onReset)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_COLLISION,
				this.onCollision
			)
		}
	}

	// 外框
	class Border {
		constructor() {
			this.init()
			this.append()
		}

		BorderLeft
		BorderTop
		BorderRight
		BorderBottom

		init() {
			this.BorderLeft = Bodies.rectangle(
				BORDER_SIZE / 2,
				ContainerHeight / 2,
				BORDER_SIZE,
				ContainerHeight,
				{
					isStatic: true,
					render: { fillStyle: "#060a19" },
					__internal_type__: "BORDER_LEFT",
				}
			)
			this.BorderTop = Bodies.rectangle(
				ContainerWidth / 2,
				BORDER_SIZE / 2,
				ContainerWidth,
				BORDER_SIZE,
				{
					isStatic: true,
					render: { fillStyle: "#060a19" },
					__internal_type__: "BORDER_TOP",
				}
			)
			this.BorderRight = Bodies.rectangle(
				ContainerWidth - BORDER_SIZE / 2,
				ContainerHeight / 2,
				BORDER_SIZE,
				ContainerHeight,
				{
					isStatic: true,
					render: { fillStyle: "#060a19" },
					__internal_type__: "BORDER_RIGHT",
				}
			)
			this.BorderBottom = Bodies.rectangle(
				ContainerWidth / 2,
				ContainerHeight - BORDER_SIZE / 2,
				ContainerWidth,
				BORDER_SIZE,
				{
					isStatic: true,
					render: { fillStyle: "#060a19" },
					__internal_type__: "BOTTOM_BORDER",
				}
			)
		}

		append() {
			Composite.add(WorldInstance, [
				this.BorderLeft,
				this.BorderTop,
				this.BorderRight,
				this.BorderBottom,
			])
		}
	}

	// 底部挡板
	class BottomHinder {

		static WIDTH = 5
		static HEIGHT = getBallSize() * 2.2 
		static Y = ContainerHeight - getBallSize() * 2.2 / 2 

		constructor() {
			this.create()
			this.append()
		}

		instances = {}

		create() {
			new Array(8).fill(0).forEach((_, index) => {
				const __internal_type__ = "BOTTOM_HINDER"
				const __internal_id__ = uuid("BOTTOM_HINDER")
				const unit = getBallSize()
				const height = BottomHinder.HEIGHT
				const width = BottomHinder.WIDTH
				this.instances[__internal_id__] = Bodies.rectangle(
					unit * (index + 1) + BORDER_SIZE,
					ContainerHeight - height / 2,
					width,
					height,
					{
						__internal_type__,
						__internal_id__,
						isStatic: true,
						render: { 
              sprite: {
                texture: BottomHinderImage,
								yScale: height / 113,
								xScale: Math.max(width / 58, 0.3) 
              }
            },
					}
				)
			})
		}

		append() {
			Composite.add(WorldInstance, Object.values(this.instances))
		}

		eventBind() {}

		eventUnBind() {}
	}

	// 顶部档条
	class TopHinder {
		constructor() {
			this.init()
			this.append()
			this.eventBind()
		}

		static WIDTH = 10
		// ? 为了在旋转的时候还是保持球的活动范围
		static HINDER_HEIGHT_UNIT = 1.7

		instanceLeft
		instanceRight

		rotate = {
			direction: -1,
			value: 0,
			area: 0.3,
			unit: 0.005,
		}

		init() {
			const ballSize = getBallSize()

			const height = ballSize * 1.5
			const leftX =
				ContainerWidth / 2 -
				(ballSize + TopHinder.WIDTH) / TopHinder.HINDER_HEIGHT_UNIT
			const leftY = BORDER_SIZE + height / 3
			const rightX =
				ContainerWidth / 2 +
				(ballSize + TopHinder.WIDTH) / TopHinder.HINDER_HEIGHT_UNIT
			const rightY = leftY

			this.instanceLeft = Bodies.rectangle(
				leftX,
				leftY,
				TopHinder.WIDTH,
				height,
				{
					__internal_center_top_pos__: {
						x: leftX,
						y: BORDER_SIZE,
					},
					isStatic: true,
					render: {
						sprite: {
							texture: Tree,
						},
					},
				}
			)
			this.instanceRight = Bodies.rectangle(
				rightX,
				rightY,
				TopHinder.WIDTH,
				height,
				{
					__internal_center_top_pos__: {
						x: rightX,
						y: BORDER_SIZE,
					},
					isStatic: true,
					render: {
						sprite: {
							texture: Tree,
						},
					},
				}
			)
		}

		append() {
			Composite.add(WorldInstance, [this.instanceLeft, this.instanceRight])
		}

		onAnimation() {
			this.rotate.value += this.rotate.direction * this.rotate.unit
			if (Math.abs(this.rotate.value) >= this.rotate.area) {
				this.rotate.direction *= -1
			}

			Body.rotate(
				this.instanceLeft,
				this.rotate.unit * Math.PI * this.rotate.direction,
				this.instanceLeft.__internal_center_top_pos__
			)
			Body.rotate(
				this.instanceRight,
				this.rotate.unit * Math.PI * this.rotate.direction,
				this.instanceRight.__internal_center_top_pos__
			)
		}

		eventBind() {
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_ANIMATION_REQUEST,
				this.onAnimation,
				this
			)
		}

		eventUnBind() {
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_ANIMATION_REQUEST,
				this.onAnimation
			)
		}
	}

	// 抽奖
	class LuckyPie {
		constructor() {
			this.eventBind()
		}

		static getTargetInfo() {
			const ballSize = getBallSize()

			return {
				width: ballSize,
				height: ballSize,
			}
		}

		instance
		loading = false
		gameover = false

		initBase() {
			LUCKY_IMAGES.forEach((item) => {
				loader(item)
			})
		}

		getPosition(_width, _height) {
			const absSize = LuckyPie.getTargetInfo()
			const width = absSize.width
			const height = (_height * width) / _width
			const { startY, height: opHeight } = LineConnect.getTargetInfo()
			const textHeight = height / 2
			return {
				x: ContainerWidth / 2 - width / 2,
				y: startY + opHeight * 2 + textHeight,
				width,
				height,
			}
		}

		init() {
			if (!this.instance) {
				const { startY, height: opHeight } = LineConnect.getTargetInfo()
				const { width, height } = LuckyPie.getTargetInfo()
				loader(LUCKY_IMAGES[0], (image, size) => {
					this.instance = new Konva.Image({
						...this.getPosition(size.width, size.height),
						image,
					})
					// 文字
					const text = new Konva.Text({
						x: ContainerWidth / 2 - (width / 2) * 2,
						y: startY + opHeight * 2,
						align: "center",
						text: "开启幸运抽奖",
						width: width * 2,
						height: height / 2,
						fontSize: ContainerWidth / 30,
					})
					Layer.add(this.instance)
					Layer.add(text)
				})

				this.initBase()
				getCurrentStepLucky().forEach((item) => {
					loader(item.image)
				})
			} else {
				loader(LUCKY_IMAGES[0], (image) => {
					this.instance.image(image)
				})
			}
		}

		// 开始抽奖
		onLucky() {
			if (this.loading) return
			this.loading = true
			const extraLucky = getCurrentStepLucky()
			const allLucky = [
				...LUCKY_IMAGES,
				...extraLucky.map((item) => item.image),
			]
			const total = 9 + extraLucky.length
			const speed = 5
			let changeTotal = 150
			let luckyResult = 0

			const lucky = () => {
				requestAnimationFrame(() => {
					changeTotal--
					if (changeTotal % speed === 0) {
						luckyResult = Math.floor(Math.random() * total)
						loader(allLucky[luckyResult], (image, size) => {
							const { x, y, width, height } = this.getPosition(
								size.width,
								size.height
							)
							this.instance.position({
								x,
								y,
							})
							this.instance.size({
								width,
								height,
							})
							this.instance.image(image)
						})
					}
					if (changeTotal > 0) {
						lucky()
					} else {
						// 统计最后抽奖数据
						let params = {}
						if (luckyResult < LUCKY_IMAGES.length) {
							params.type = LUCKY_TYPE_MAP.GRID_LIGHT
							params.value = luckyResult
						} else {
							const target = extraLucky[luckyResult - LUCKY_IMAGES.length]
							params.type = target.type
							params.value = target.value
						}
						this.loading = false
						// 游戏结束就不用算积分了
						if (!this.gameover)
							EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_LUCKY_DONE, params)
						this.gameover = false
					}
				})
			}
			setTimeout(lucky, 500)
		}

		onGameOver() {
			this.gameover = false
		}

		eventBind() {
			EVENT_EMITTER.addListener(EVENT_EMITTER_NAME.ON_RESET, this.init, this)
			EVENT_EMITTER.addListener(EVENT_EMITTER_NAME.ON_LUCKY, this.onLucky, this)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_GAME_OVER,
				this.onGameOver,
				this
			)
		}

		eventUnBind() {
			EVENT_EMITTER.removeListener(EVENT_EMITTER_NAME.ON_RESET, this.init)
			EVENT_EMITTER.removeListener(EVENT_EMITTER_NAME.ON_LUCKY, this.onLucky)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_GAME_OVER,
				this.onGameOver
			)
		}
	}

	// 九宫格
	class GridBlock {
		constructor() {
			this.init()
			this.eventBind()
		}

		static getTargetInfo() {
			const ballSize = getBallSize()
			const size = ballSize / 1.2
			const startX = ContainerWidth / 2 - size * 1.5
			const startY = (TopHinder.HINDER_HEIGHT_UNIT + 0.5) * ballSize
			return {
				size,
				startX,
				startY,
			}
		}

		instances = []
		instancesLightMap = new Array(9).fill(false)
		isInit = true

		// {
		//   '012': {
		//     0: false,
		//     1: false,
		//     2: false
		//   }
		// }
		generateLineConnectMap() {
			return [
				[0, 1, 2],
				[3, 4, 5],
				[6, 7, 8],
				[0, 3, 6],
				[1, 4, 7],
				[2, 5, 8],
				[0, 4, 8],
				[2, 4, 7],
			].reduce((acc, cur) => {
				const key = cur.join("")
				acc[key] = cur.reduce((acc, cur) => {
					acc[cur] = false
					return acc
				}, {})
				return acc
			}, {})
		}

		init() {
			// 已存在则无须初始化
			if (this.instances.length) {
				return this.instances.forEach((_, index) => {
					this.stateChange(false, index)
				})
			}

			const { size, startX, startY } = GridBlock.getTargetInfo()

			GRID_IMAGES.forEach((item, index) => {
				const xUnit = index % 3
				const yUnit = Math.floor(index / 3)
				loader(item, (image) => {
					const instance = new Konva.Image({
						x: startX + xUnit * size,
						y: startY + yUnit * size,
						width: size,
						height: size,
						image,
					})
					this.instances.push(instance)
					Layer.add(instance)
				})
			})
		}

		// 重置
		onReset() {
			if (this.isInit) {
				this.isInit = false
				return
			}
			this.init()
		}

		// 判断是否触发连线
		lineConnectJudge(needNext) {
			const lineConnectMap = this.generateLineConnectMap()
			const counter = Object.values(lineConnectMap).reduce((acc, cur) => {
				if (Object.keys(cur).every((item) => this.instancesLightMap[item]))
					acc++
				return acc
			}, 0)

			EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_LINE_CONNECT, counter, needNext)
		}

		stateChange(isLight, index) {
			this.instancesLightMap[index] = isLight
			const target = isLight ? GRID_IMAGES_ACTIVE[index] : GRID_IMAGES[index]
			loader(target, (image) => {
				this.instances[index].image(image)
			})
		}

		// 球进洞点亮宫格
		// index 索引
		// needNext 是否需要触发ON_NEXT事件
		onGridLighting(index, needNext) {
			this.stateChange(true, index)
			this.lineConnectJudge(needNext)
			EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_SCORE, GAME_DATA.gridLightScore + GAME_DATA.score)
		}

		eventBind() {
			EVENT_EMITTER.addListener(EVENT_EMITTER_NAME.ON_RESET, this.onReset, this)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_GRID_LIGHTING,
				this.onGridLighting,
				this
			)
		}

		eventUnBind() {
			EVENT_EMITTER.removeListener(EVENT_EMITTER_NAME.ON_RESET, this.onReset)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_GRID_LIGHTING,
				this.onGridLighting
			)
		}
	}

	// 连线记录
	class LineConnect {
		constructor() {
			this.init()
			this.eventBind()
		}

		static COUNT = 8
		static getTargetInfo() {
			const {
				size,
				startX: blockStartX,
				startY: blockStartY,
			} = GridBlock.getTargetInfo()

			return {
				width: size * 3,
				height: size * 3,
				startX: blockStartX + size * 3.5,
				startY: blockStartY,
			}
		}

		instances = []
		isInit = true
		connectCounter = 0

		init() {
			this.connectCounter = 0

			// 已存在则无须初始化
			if (this.instances.length) {
				return this.instances.forEach((_, index) => {
					this.stateChange(true, index)
				})
			}

			const { width, height, startX, startY } = LineConnect.getTargetInfo()

			const wrapper = new Konva.Group({
				x: startX,
				y: startY,
				width,
				height,
			})
			const commonConfig = {
				stroke: 'gray',
			}
			const line1 = new Konva.Line({
				points: [0, 0, width, 0],
				...commonConfig,
			})
			const line2 = new Konva.Line({
				points: [0, height / 2, width, height / 2],
				...commonConfig,
			})
			const line3 = new Konva.Line({
				points: [0, height, width, height],
				...commonConfig,
			})

			const line4 = new Konva.Line({
				points: [0, 0, 0, height],
				...commonConfig,
			})
			const line5 = new Konva.Line({
				points: [width / 2, 0, width / 2, height],
				...commonConfig,
			})
			const line6 = new Konva.Line({
				points: [width, 0, width, height],
				...commonConfig,
			})

			const line7 = new Konva.Line({
				points: [0, 0, width, height],
				...commonConfig,
			})
			const line8 = new Konva.Line({
				points: [width, 0, 0, height],
				...commonConfig,
			})

			wrapper.add(line1)
			wrapper.add(line2)
			wrapper.add(line3)
			wrapper.add(line4)
			wrapper.add(line5)
			wrapper.add(line6)
			wrapper.add(line7)
			wrapper.add(line8)

			this.instances.push(line1, line2, line3, line4, line5, line6, line7, line8)


			Layer.add(wrapper)
		}

		// 重置
		onReset() {
			if (this.isInit) {
				this.isInit = false
				return
			}
			this.init()
		}

		stateChange(isNormal, index) {
			this.instances[index].stroke(isNormal ? 'gray' : 'rgb(201, 233, 150)')
		}

		// 触发连线
		onLineConnect(count, needNext) {
			new Array(count).fill(0).forEach((_, index) => {
				this.stateChange(false, this.instances.length - index - 1)
			})
			const addCount = count - this.connectCounter
			this.connectCounter = count
			!!this.connectCounter &&
				EVENT_EMITTER.emit(
					EVENT_EMITTER_NAME.ON_SCORE,
					addCount * GAME_DATA.lineConnectScore[this.connectCounter - 1] || 0 + GAME_DATA.score
				)
			EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_NEXT, !!needNext)
		}

		onDataGet() {
			return {
				lineConnectCount: this.connectCounter,
			}
		}

		eventBind() {
			EVENT_EMITTER.addListener(EVENT_EMITTER_NAME.ON_RESET, this.onReset, this)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_LINE_CONNECT,
				this.onLineConnect,
				this
			)
		}

		eventUnBind() {
			EVENT_EMITTER.removeListener(EVENT_EMITTER_NAME.ON_RESET, this.onReset)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_LINE_CONNECT,
				this.onLineConnect
			)
		}
	}

	// 积分
	class Score {
		constructor() {
			this.init()
			this.eventBind()
		}

		instance

		fillText() {
			return `🏆 ：${GAME_DATA.currentStep + 1} 📝 ：${GAME_DATA.score}`
		}

		init() {
			if (!this.instance) {
				this.instance = new Konva.Text({
					x: 0,
					y: BORDER_SIZE * 2,
					align: "right",
					text: this.fillText(),
					width: ContainerWidth - BORDER_SIZE * 2,
					fontSize: ContainerWidth / 25,
				})
				Layer.add(this.instance)
			} else {
				this.instance.text(this.fillText())
			}
		}

		onScore(score) {
			GAME_DATA.score = score
			StorageInstance.setValue({
				score: GAME_DATA.score,
			})
			this.instance.text(this.fillText())
		}

		// 抽奖结果
		onLuckyDone({ value, type }) {
			switch (type) {
				case LUCKY_TYPE_MAP.SCORE:
					this.onScore(value + GAME_DATA.score)
					break
				case LUCKY_TYPE_MAP.GRID_LIGHT:
					EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_GRID_LIGHTING, value)
			}
		}

		eventBind() {
			EVENT_EMITTER.addListener(EVENT_EMITTER_NAME.ON_RESET, this.init, this)
			EVENT_EMITTER.addListener(EVENT_EMITTER_NAME.ON_SCORE, this.onScore, this)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_LUCKY_DONE,
				this.onLuckyDone,
				this
			)
		}

		eventUnBind() {
			EVENT_EMITTER.removeListener(EVENT_EMITTER_NAME.ON_RESET, this.init)
			EVENT_EMITTER.removeListener(EVENT_EMITTER_NAME.ON_SCORE, this.onScore)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_LUCKY_DONE,
				this.onLuckyDone
			)
		}
	}

	// 碰撞
	class Collision {
		constructor() {
			this.eventBind()
		}

		collisionMap = {}

		collisionTimeout = {}

		onCollisionStart = (event) => {
			event.pairs.forEach((pair) => {
				const { bodyA, bodyB } = pair
				const collisionMapKeyA = bodyA.id + "--" + bodyB.id
				const collisionMapKeyB = bodyB.id + "--" + bodyA.id
				// 去除之前的碰撞
				delete this.collisionMap[collisionMapKeyA]
				delete this.collisionMap[collisionMapKeyB]
				clearTimeout(this.collisionTimeout[collisionMapKeyA])
				clearTimeout(this.collisionTimeout[collisionMapKeyB])
				delete this.collisionTimeout[collisionMapKeyA]
				delete this.collisionTimeout[collisionMapKeyB]

				this.collisionMap[collisionMapKeyA] = pair

				EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_COLLISION, bodyA, bodyB)

				// 1s 后碰撞仍然存在则确定为静止
				this.collisionTimeout[collisionMapKeyA] = setTimeout(() => {
					if (this.collisionMap[collisionMapKeyA]) {
						const target = this.collisionMap[collisionMapKeyA]
						EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_SLEEP, target)
						delete this.collisionMap[collisionMapKeyA]
						delete this.collisionTimeout[collisionMapKeyA]
					}
				}, 1000)
			})
		}

		onCollisionEnd = (event) => {
			event.pairs.forEach((pair) => {
				const { bodyA, bodyB } = pair
				const collisionMapKeyA = bodyA.id + "--" + bodyB.id
				const collisionMapKeyB = bodyB.id + "--" + bodyA.id
				delete this.collisionMap[collisionMapKeyA]
				delete this.collisionMap[collisionMapKeyB]
				clearTimeout(this.collisionTimeout[collisionMapKeyA])
				clearTimeout(this.collisionTimeout[collisionMapKeyB])
				delete this.collisionTimeout[collisionMapKeyA]
				delete this.collisionTimeout[collisionMapKeyB]
			})
		}

		onGamePlay() {
			// 去除碰撞key缓存
			this.collisionMap = {}
			// 去除定时器
			Object.values(this.collisionTimeout).forEach((item) => clearTimeout(item))
			this.collisionTimeout = {}
		}

		eventBind() {
			MatterEvents.on(EngineInstance, "collisionStart", this.onCollisionStart)
			MatterEvents.on(EngineInstance, "collisionEnd", this.onCollisionEnd)

			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_RESET,
				this.onGamePlay,
				this
			)
		}

		eventUnBind() {
			MatterEvents.off(EngineInstance, "collisionStart", this.onCollisionStart)
			MatterEvents.off(EngineInstance, "collisionEnd", this.onCollisionEnd)

			EVENT_EMITTER.removeListener(EVENT_EMITTER_NAME.ON_RESET, this.onGamePlay)
		}
	}

	// 发球
	class ServeBall {
		constructor() {
			this.eventBind()
		}

		disabled = true
		lucky = false

		serverBall = () => {
			if (this.disabled || this.lucky) return
			this.disabled = true
			new Ball()
		}

		onNextBall() {
			this.disabled = false
		}

		onDisabled() {
			this.disabled = true
		}

		onLucky() {
			this.lucky = true
		}

		onLuckyDone() {
			this.lucky = false
		}

		eventBind() {
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_NEXT_BALL,
				this.onNextBall,
				this
			)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_GAME_OVER,
				this.onDisabled,
				this
			)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_GAME_PLAY,
				this.onNextBall,
				this
			)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_GAME_STATIC,
				this.onDisabled,
				this
			)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_GAME_START,
				this.onNextBall,
				this
			)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_GAME_STOP,
				this.onDisabled,
				this
			)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_GAME_WIN,
				this.onDisabled,
				this
			)
			EVENT_EMITTER.addListener(EVENT_EMITTER_NAME.ON_LUCKY, this.onLucky, this)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_LUCKY_DONE,
				this.onLuckyDone,
				this
			)
		}

		eventUnBind() {
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_NEXT_BALL,
				this.onNextBall
			)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_GAME_OVER,
				this.onDisabled
			)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_GAME_PLAY,
				this.onNextBall
			)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_GAME_STATIC,
				this.onDisabled
			)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_GAME_START,
				this.onNextBall
			)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_GAME_STOP,
				this.onDisabled
			)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_GAME_WIN,
				this.onDisabled
			)
			EVENT_EMITTER.removeListener(EVENT_EMITTER_NAME.ON_LUCKY, this.onLucky)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_LUCKY_DONE,
				this.onLuckyDone
			)
		}
	}

	// 动画定时器
	class Animation {
		constructor() {
			this.eventBind()
		}

		isStop = false

		animation() {
			if (this.isStop) return
			EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_ANIMATION_REQUEST)
			requestAnimationFrame(this.animation.bind(this))
		}

		start() {
			this.isStop = false
			this.animation()
		}

		stop() {
			this.isStop = true
		}

		eventBind() {
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_GAME_OVER,
				this.stop,
				this
			)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_GAME_PLAY,
				this.start,
				this
			)
		}

		eventUnBind() {
			EVENT_EMITTER.removeListener(EVENT_EMITTER_NAME.ON_GAME_OVER, this.stop)
			EVENT_EMITTER.removeListener(EVENT_EMITTER_NAME.ON_GAME_PLAY, this.start)
		}
	}

	// 缓存相关
	// 存储游戏信息
	class StorageFactory {
		key = "fruit_alliance"

		static Storage = localStorage

		base = {
			score: 0,
			currentStep: 0,
		}

		init() {
			this.getValue()
		}

		reset() {
			this.setValue(this.base)
		}

		getValue() {
			let result = StorageFactory.Storage.getItem(this.key)
			if (!result) {
				StorageFactory.Storage.setItem(this.key, JSON.stringify(this.base))
				return this.base
			} else {
				return JSON.parse(result)
			}
		}

		setValue(value) {
			const origin = this.getValue()
			StorageFactory.Storage.setItem(
				this.key,
				JSON.stringify({
					...origin,
					...value,
				})
			)
		}
	}

	// 交互相关
	class Interactive {
		constructor() {
			this.init()
			this.eventBind()
		}

		guide = {
			instance: null,
		}
		gameComplete = {
			instance: null,
		}
		gameOver = {
			instance: null,
		}
		gameStop = {
			instance: null,
		}
		gameWin = {
			instance: null,
		}
		nextBll = {
			instance: null,
		}
		luckyDone = {
			instance: null,
		}

		serveBallInstance = new ServeBall()
		ServeBallButton
		serveBallTimer
		StartButton
		startTimer

    modalOptions = {
      fill: "rgb(201, 233, 150)",
      cornerRadius: 12
    }

		getCommonSizeInfo() {
			const width = ContainerWidth / 2
			const height = width / 1.5
			const x = ContainerWidth / 2 - width / 2
			const y = ContainerHeight / 2 - height / 2
			return {
				width,
				height,
				x,
				y,
			}
		}

		// 发球
		handleServeBall = () => {
			clearTimeout(this.serveBallTimer)
			this.ServeBallButton.opacity(1)
			this.serveBallTimer = setTimeout(() => {
				this.ServeBallButton.opacity(0.7)
			}, 100)

			this.serveBallInstance.serverBall()
		}

		// 暂停
		handleStop = () => {
			clearTimeout(this.startTimer)
			this.StartButton.opacity(1)
			this.startTimer = setTimeout(() => {
				this.StartButton.opacity(0.7)
			}, 100)

			EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_GAME_STOP)
		}

    // 跑马灯
    initCarousel() {
      const fontSize = ContainerWidth / 40
      const width = ContainerWidth - BORDER_SIZE * 2
      const height = fontSize * 2
      const wrapper = new Konva.Group({
        x: BORDER_SIZE,
				y: BORDER_SIZE,
				width,
				height,
      })
      const text = new Konva.Text({
        fontSize,
        x: 0,
        y: 0,
        align: "left",
        verticalAlign: 'middle',
        text: "开启幸运抽奖",
        width,
        height,
        fill: '#ff6010'
      })
      const background = new Konva.Rect({
        width,
        height,
        fill: 'rgb(255, 249, 238)'
      })

      wrapper.add(background)
      wrapper.add(text)
      ModalLayer.add(wrapper)
    }

		// 按钮
		initButtonGroup() {
      const fontSize = ContainerWidth / 30
			const size = getBallSize() * 1.5
			const { startY, height: opHeight } = LineConnect.getTargetInfo()
			const eY = BottomHinder.Y - BottomHinder.HEIGHT / 2
			const sY = startY + opHeight
			const y = (eY - sY) / 2 + sY
      this.ServeBallButton = new Konva.Group({
        width: size,
        height: size,
        x: ContainerWidth / 5 - size / 2,
        y,
        opacity: 0.7,
      })
      this.ServeBallButton.on("click", this.handleServeBall)
			this.ServeBallButton.on("tap", this.handleServeBall)

      this.StartButton = new Konva.Group({
        width: size,
        height: size,
        x: (ContainerWidth / 5) * 4 - size / 2,
        y,
        opacity: 0.7,
      })
      this.StartButton.on("click", this.handleStop)
			this.StartButton.on("tap", this.handleStop)

			loader(ServeBallImage, (image, { width, height }) => {
				const realWidth = Math.min(getBallSize(), 32) 
				const realHeight = height * realWidth / width 
				const icon = new Konva.Image({
					width: realWidth,
					height: realHeight,
					x: size - realWidth / 2,
					y: 0,
					image,
				})
        const text = new Konva.Text({
          fontSize,
          width: size,
          height: size,
          align: 'center',
          verticalAlign: 'middle',
          text: '发射',
          x: 0,
          y: 0,
        })
				const background = new Konva.Circle({
					fill: 'rgb(201, 233, 150)',
					x: size / 2,
					y:  size / 2,
					width: size,
					height: size,
				})
				
				this.ServeBallButton.add(background)
        this.ServeBallButton.add(icon)
        this.ServeBallButton.add(text)
				ModalLayer.add(this.ServeBallButton)
			})
			loader(StopImage, (image, { width, height }) => {
				const realWidth = Math.min(getBallSize(), 32) 
				const realHeight = height * realWidth / width 
				const icon = new Konva.Image({
					width: realWidth,
					height: realHeight,
					x: size - realWidth / 2,
					y: 0,
					image,
				})
        const text = new Konva.Text({
          fontSize,
          width: size,
          height: size,
          align: 'center',
          verticalAlign: 'middle',
          text: '暂停',
          x: 0,
          y: 0,
        })
				const background = new Konva.Circle({
					fill: 'rgb(201, 233, 150)',
					x: size / 2,
					y: size / 2,
					width: size,
					height: size,
				})

				this.StartButton.add(background)
				this.StartButton.add(icon)
        this.StartButton.add(text)
				ModalLayer.add(this.StartButton)
			})
		}

		// 提示框的group
		generateWrapper(modalOptions={}) {
      const { action, children={}, fruitIcon } = modalOptions
			let title 
			let content
			const wrapper = new Konva.Group({
				x: 0,
				y: 0,
				width: ContainerWidth,
				height: ContainerHeight,
				visible: false,
			})
			const mask = new Konva.Rect({
				width: ContainerWidth,
				height: ContainerHeight,
				x: 0,
				y: 0,
				fill: "#000",
				opacity: 0.5,
			})

      // 弹框
      const modalSizeInfo = this.getCommonSizeInfo()
      const modal = new Konva.Rect({
				...modalSizeInfo,
        ...this.modalOptions,
			})
      if(action) {
				modal.on('click', action)
				modal.on('tap', action)
			}

			const getText = (content) => typeof content === 'function' ? content() : content 

			const update = () => {
				if(typeof children.title === 'function') title.text(getText(children.text))
				if(typeof children.content === 'function') content.text(getText(children.content))
			}

			if(children.title) {
				const fontSize = ContainerWidth / 25
				title = new Konva.Text({
					width: modalSizeInfo.width,
					text: getText(children.title),
					align: 'center',
					verticalAlign: 'middle',
					fontSize,
					height: fontSize * 2,
					x: modalSizeInfo.x,
					y: modalSizeInfo.y,
					fillStyle: '#000'
				})
			}
			if(children.content) {
				const fontSize = ContainerWidth / 35
				content = new Konva.Text({
					width: modalSizeInfo.width,
					text: getText(children.content),
					align: 'center',
					verticalAlign: 'middle',
					fontSize,
					height: modalSizeInfo.height - ContainerWidth / 20 * 4,
					x: modalSizeInfo.x,
					y: modalSizeInfo.y + ContainerWidth / 20 * 2,
					fillStyle: '#000'
				})
			}

      // 水果图标
      loader(fruitIcon, (image, { width, height }) => {
				const realWidth = getBallSize()
				const realHeight = height * realWidth / width 
        const icon = new Konva.Image({
          width: realWidth,
          height: realHeight,
          image,
          x: modalSizeInfo.x + modalSizeInfo.width - realWidth / 1.5, 
          y: modalSizeInfo.y - realHeight / 3
        })
        wrapper.add(icon)
      })

			wrapper.add(mask)
      wrapper.add(modal)
			title && wrapper.add(title)
			content && wrapper.add(content)
			return {
				instance: wrapper,
				title: title,
				content: content,
				update
			}
		}

		// 游戏通过可以点击重玩
		initGameComplete() {
			this.gameComplete = this.generateWrapper({
        action: () => {
          GameInstance.gameRePlay()
          this.gameComplete.instance.visible(false)
        },
        fruitIcon: GRID_IMAGES_ACTIVE[1],
				children: {
					title: '恭喜通关',
					content: '点击重玩~'
				}
      })
			ModalLayer.add(this.gameComplete.instance)
		}

		// 游戏失败可以点击重玩
		// 从本关开始且积分不清0
		initGameOver() {
			this.gameOver = this.generateWrapper({
        action: () => {
          GameInstance.gameRePlay()
          this.gameOver.instance.visible(false)
        },
        fruitIcon: GRID_IMAGES_ACTIVE[2],
				children: {
					title: '失败',
					content: () => '点击继续~'
				}
      })
			ModalLayer.add(this.gameOver.instance)
		}

		// 游戏暂停可以重新继续
		initGameStop() {
			this.gameStop = this.generateWrapper({
        action: () => {
          EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_GAME_START)
          this.gameStop.instance.visible(false)
        },
        fruitIcon: GRID_IMAGES_ACTIVE[3],
				children: {
					title: '暂停',
					content: '点击继续~'
				}
      })
			ModalLayer.add(this.gameStop.instance)
		}

		initGameWin() {
			this.gameWin = this.generateWrapper({
        fruitIcon: GRID_IMAGES_ACTIVE[4],
				children: {
					title: '恭喜过关',
					content: '即将进入下一关~'
				}
      })
			ModalLayer.add(this.gameWin.instance)
		}

		initNextBall() {
			this.nextBll = this.generateWrapper({
        fruitIcon: GRID_IMAGES_ACTIVE[5]
      })
			ModalLayer.add(this.nextBll.instance)
		}

		initLuckyDone() {
			this.luckyDone = this.generateWrapper({
        fruitIcon: GRID_IMAGES_ACTIVE[6]
      })
			ModalLayer.add(this.luckyDone.instance)
		}

		init() {

			this.initButtonGroup()

			this.initGameComplete()
			this.initGameOver()
			this.initGameStop()
			this.initGameWin()
			this.initNextBall()
			this.initLuckyDone()

      // this.initCarousel()
		}

		// 动画
		animation() {}

		// 游戏引导
		guide() {
			// TODO
		}

		// 游戏通关
		onGameComplete() {
			GameInstance.gameInfoReset()
			this.gameComplete.update()
			this.gameComplete.instance.visible(true)
		}

		// 游戏结束
		onGameOver() {
			this.gameComplete.update()
			this.gameOver.instance.visible(true)
		}

		// 游戏暂停
		onGameStop() {
			this.gameComplete.update()
			this.gameStop.instance.visible(true)
		}

		// 游戏通关（本关）
		onGameWin() {
			const value = StorageInstance.getValue()
			if (value.currentStep + 1 === GAME_DATA.step.length) {
				this.onGameComplete()
			} else {
				this.gameComplete.update()
				this.gameWin.instance.visible(true)
				const newStep = value.currentStep + 1
				setTimeout(() => {
					StorageInstance.setValue({
						currentStep: newStep,
					})
					GAME_DATA.currentStep = newStep
					this.gameWin.instance.visible(false)
					EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_RESET)
				}, 2000)
			}
		}

		// 下一球
		onNextBall() {
			console.log("next ball")
			// TODO
		}

		// 下一步
		onNext(needNext) {
			// 判断一下是否游戏可以下一关
			GAME_DATA.step[GAME_DATA.currentStep].isWin().then((isWin) => {
				if (isWin) {
					EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_GAME_WIN)
				} else if(needNext) {
					EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_NEXT_BALL)
				}
			})
		}

		// 抽奖完成
		onLuckyDone({ value, type }) {
			console.log("lucky done")
			// TODO
		}

		eventBind() {
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_GAME_OVER,
				this.onGameOver,
				this
			)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_GAME_STOP,
				this.onGameStop,
				this
			)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_GAME_WIN,
				this.onGameWin,
				this
			)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_NEXT_BALL,
				this.onNextBall,
				this
			)
			EVENT_EMITTER.addListener(EVENT_EMITTER_NAME.ON_NEXT, this.onNext, this)
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_LUCKY_DONE,
				this.onLuckyDone,
				this
			)
		}

		eventUnBind() {
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_GAME_OVER,
				this.onGameOver
			)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_GAME_STOP,
				this.onGameStop
			)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_GAME_WIN,
				this.onGameWin
			)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_NEXT_BALL,
				this.onNextBall
			)
			EVENT_EMITTER.removeListener(EVENT_EMITTER_NAME.ON_NEXT, this.onNext)
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_LUCKY_DONE,
				this.onLuckyDone
			)
		}
	}

	// 游戏
	class Game {
		constructor() {
			this.eventBind()
			this.gameInfoInit()
		}

		animation
		luckyPie
		gridBlock
		lineConnect
		topHinder
		collision
		hinder
		bottomHinder
		border
		score
		interactive

		// 游戏开始
		start() {
			this.animation = new Animation()
			this.luckyPie = new LuckyPie()
			this.gridBlock = new GridBlock()
			this.lineConnect = new LineConnect()
			this.topHinder = new TopHinder()
			this.collision = new Collision()
			this.hinder = new Hinder()
			this.bottomHinder = new BottomHinder()
			this.border = new Border()
			this.score = new Score()
			this.interactive = new Interactive()

			this.gameRePlay()
		}

		// 重玩
		gameRePlay(isRest = false /*是否从第一关开始玩*/) {
			if (isRest) this.gameInfoReset()
			this.gameInfoInit()
			EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_GAME_PLAY)
			EVENT_EMITTER.emit(EVENT_EMITTER_NAME.ON_RESET)
		}

		// 数据重置
		gameInfoReset() {
			StorageInstance.reset()
		}

		// 数据初始化
		gameInfoInit() {
			const value = StorageInstance.getValue()
			Object.entries(value).forEach((item) => {
				const [key, value] = item
				GAME_DATA[key] = value
			})
		}

		// 数据获取
		onDataGet(callback) {
			callback(this.lineConnect.onDataGet())
		}

		eventBind() {
			EVENT_EMITTER.addListener(
				EVENT_EMITTER_NAME.ON_DATA_GET,
				this.onDataGet,
				this
			)
		}

		eventUnBind() {
			EVENT_EMITTER.removeListener(
				EVENT_EMITTER_NAME.ON_DATA_GET,
				this.onDataGet
			)
		}
	}

	const StorageInstance = new StorageFactory()
	const GameInstance = new Game()
	GameInstance.start()

  window.onresize = debounce(function() {
    window.location.reload()
  }, 200)

})()
